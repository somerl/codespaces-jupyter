{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 7.493920299290085}, "default_policy": {"total_loss": 7.493920299290085, "policy_loss": -0.026838459565973423, "vf_loss": 7.516720522441335, "vf_loss_unclipped": 164.78073136384552, "vf_explained_var": 0.12775503438927216, "entropy": 0.6767837288918526, "mean_kl_loss": 0.020191203476624866, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 95.0, "episode_reward_min": 9.0, "episode_reward_mean": 21.546448087431695, "episode_len_mean": 21.546448087431695, "episode_media": {}, "episodes_this_iter": 183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.0, 12.0, 25.0, 10.0, 41.0, 16.0, 16.0, 47.0, 26.0, 16.0, 25.0, 19.0, 19.0, 16.0, 19.0, 33.0, 38.0, 95.0, 15.0, 17.0, 18.0, 17.0, 24.0, 17.0, 23.0, 11.0, 12.0, 16.0, 16.0, 15.0, 16.0, 11.0, 15.0, 12.0, 18.0, 20.0, 13.0, 25.0, 33.0, 17.0, 17.0, 14.0, 26.0, 14.0, 16.0, 41.0, 12.0, 18.0, 28.0, 20.0, 13.0, 33.0, 21.0, 19.0, 21.0, 16.0, 19.0, 28.0, 15.0, 25.0, 18.0, 12.0, 21.0, 16.0, 26.0, 22.0, 50.0, 30.0, 10.0, 24.0, 11.0, 22.0, 10.0, 24.0, 15.0, 18.0, 16.0, 16.0, 13.0, 16.0, 12.0, 17.0, 21.0, 26.0, 26.0, 16.0, 14.0, 15.0, 10.0, 15.0, 18.0, 25.0, 20.0, 12.0, 16.0, 29.0, 11.0, 17.0, 16.0, 31.0, 35.0, 23.0, 15.0, 23.0, 11.0, 28.0, 11.0, 13.0, 20.0, 15.0, 27.0, 24.0, 16.0, 10.0, 14.0, 41.0, 22.0, 30.0, 29.0, 14.0, 87.0, 15.0, 25.0, 76.0, 18.0, 47.0, 25.0, 9.0, 38.0, 20.0, 12.0, 22.0, 21.0, 11.0, 16.0, 35.0, 9.0, 10.0, 29.0, 16.0, 19.0, 11.0, 25.0, 16.0, 31.0, 23.0, 17.0, 59.0, 35.0, 13.0, 9.0, 13.0, 10.0, 27.0, 24.0, 22.0, 28.0, 15.0, 29.0, 10.0, 20.0, 19.0, 42.0, 15.0, 19.0, 26.0, 18.0, 29.0, 13.0, 21.0, 18.0, 10.0, 23.0, 14.0, 21.0, 11.0, 15.0, 38.0, 27.0, 15.0, 27.0, 14.0, 23.0], "episode_lengths": [40, 12, 25, 10, 41, 16, 16, 47, 26, 16, 25, 19, 19, 16, 19, 33, 38, 95, 15, 17, 18, 17, 24, 17, 23, 11, 12, 16, 16, 15, 16, 11, 15, 12, 18, 20, 13, 25, 33, 17, 17, 14, 26, 14, 16, 41, 12, 18, 28, 20, 13, 33, 21, 19, 21, 16, 19, 28, 15, 25, 18, 12, 21, 16, 26, 22, 50, 30, 10, 24, 11, 22, 10, 24, 15, 18, 16, 16, 13, 16, 12, 17, 21, 26, 26, 16, 14, 15, 10, 15, 18, 25, 20, 12, 16, 29, 11, 17, 16, 31, 35, 23, 15, 23, 11, 28, 11, 13, 20, 15, 27, 24, 16, 10, 14, 41, 22, 30, 29, 14, 87, 15, 25, 76, 18, 47, 25, 9, 38, 20, 12, 22, 21, 11, 16, 35, 9, 10, 29, 16, 19, 11, 25, 16, 31, 23, 17, 59, 35, 13, 9, 13, 10, 27, 24, 22, 28, 15, 29, 10, 20, 19, 42, 15, 19, 26, 18, 29, 13, 21, 18, 10, 23, 14, 21, 11, 15, 38, 27, 15, 27, 14, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48149433531662256, "mean_inference_ms": 1.2704409590008197, "mean_action_processing_ms": 0.10576620008968701, "mean_env_wait_ms": 0.05114325819179971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045256536515032655, "StateBufferConnector_ms": 0.0036965302430866844, "ViewRequirementAgentConnector_ms": 0.2534010371223825}}, "episode_reward_max": 95.0, "episode_reward_min": 9.0, "episode_reward_mean": 21.546448087431695, "episode_len_mean": 21.546448087431695, "episodes_this_iter": 183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.0, 12.0, 25.0, 10.0, 41.0, 16.0, 16.0, 47.0, 26.0, 16.0, 25.0, 19.0, 19.0, 16.0, 19.0, 33.0, 38.0, 95.0, 15.0, 17.0, 18.0, 17.0, 24.0, 17.0, 23.0, 11.0, 12.0, 16.0, 16.0, 15.0, 16.0, 11.0, 15.0, 12.0, 18.0, 20.0, 13.0, 25.0, 33.0, 17.0, 17.0, 14.0, 26.0, 14.0, 16.0, 41.0, 12.0, 18.0, 28.0, 20.0, 13.0, 33.0, 21.0, 19.0, 21.0, 16.0, 19.0, 28.0, 15.0, 25.0, 18.0, 12.0, 21.0, 16.0, 26.0, 22.0, 50.0, 30.0, 10.0, 24.0, 11.0, 22.0, 10.0, 24.0, 15.0, 18.0, 16.0, 16.0, 13.0, 16.0, 12.0, 17.0, 21.0, 26.0, 26.0, 16.0, 14.0, 15.0, 10.0, 15.0, 18.0, 25.0, 20.0, 12.0, 16.0, 29.0, 11.0, 17.0, 16.0, 31.0, 35.0, 23.0, 15.0, 23.0, 11.0, 28.0, 11.0, 13.0, 20.0, 15.0, 27.0, 24.0, 16.0, 10.0, 14.0, 41.0, 22.0, 30.0, 29.0, 14.0, 87.0, 15.0, 25.0, 76.0, 18.0, 47.0, 25.0, 9.0, 38.0, 20.0, 12.0, 22.0, 21.0, 11.0, 16.0, 35.0, 9.0, 10.0, 29.0, 16.0, 19.0, 11.0, 25.0, 16.0, 31.0, 23.0, 17.0, 59.0, 35.0, 13.0, 9.0, 13.0, 10.0, 27.0, 24.0, 22.0, 28.0, 15.0, 29.0, 10.0, 20.0, 19.0, 42.0, 15.0, 19.0, 26.0, 18.0, 29.0, 13.0, 21.0, 18.0, 10.0, 23.0, 14.0, 21.0, 11.0, 15.0, 38.0, 27.0, 15.0, 27.0, 14.0, 23.0], "episode_lengths": [40, 12, 25, 10, 41, 16, 16, 47, 26, 16, 25, 19, 19, 16, 19, 33, 38, 95, 15, 17, 18, 17, 24, 17, 23, 11, 12, 16, 16, 15, 16, 11, 15, 12, 18, 20, 13, 25, 33, 17, 17, 14, 26, 14, 16, 41, 12, 18, 28, 20, 13, 33, 21, 19, 21, 16, 19, 28, 15, 25, 18, 12, 21, 16, 26, 22, 50, 30, 10, 24, 11, 22, 10, 24, 15, 18, 16, 16, 13, 16, 12, 17, 21, 26, 26, 16, 14, 15, 10, 15, 18, 25, 20, 12, 16, 29, 11, 17, 16, 31, 35, 23, 15, 23, 11, 28, 11, 13, 20, 15, 27, 24, 16, 10, 14, 41, 22, 30, 29, 14, 87, 15, 25, 76, 18, 47, 25, 9, 38, 20, 12, 22, 21, 11, 16, 35, 9, 10, 29, 16, 19, 11, 25, 16, 31, 23, 17, 59, 35, 13, 9, 13, 10, 27, 24, 22, 28, 15, 29, 10, 20, 19, 42, 15, 19, 26, 18, 29, 13, 21, 18, 10, 23, 14, 21, 11, 15, 38, 27, 15, 27, 14, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48149433531662256, "mean_inference_ms": 1.2704409590008197, "mean_action_processing_ms": 0.10576620008968701, "mean_env_wait_ms": 0.05114325819179971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045256536515032655, "StateBufferConnector_ms": 0.0036965302430866844, "ViewRequirementAgentConnector_ms": 0.2534010371223825}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 260.12803213793404, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 15377.003, "sample_time_ms": 7690.591, "synch_weights_time_ms": 2.32}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 183, "training_iteration": 1, "trial_id": "1b194_00000", "date": "2023-08-15_12-42-15", "timestamp": 1692103335, "time_this_iter_s": 15.384625911712646, "time_total_s": 15.384625911712646, "pid": 7305, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc6cfada170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15.384625911712646, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.500000000000004, "ram_util_percent": 23.22272727272727}}
{"evaluation": {"sampler_results": {"episode_reward_max": 309.0, "episode_reward_min": 25.0, "episode_reward_mean": 76.15, "episode_len_mean": 76.15, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.0, 109.0, 29.0, 70.0, 49.0, 84.0, 50.0, 43.0, 43.0, 309.0, 80.0, 27.0, 25.0, 40.0, 80.0, 150.0, 33.0, 58.0, 90.0, 71.0], "episode_lengths": [83, 109, 29, 70, 49, 84, 50, 43, 43, 309, 80, 27, 25, 40, 80, 150, 33, 58, 90, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44882094140440787, "mean_inference_ms": 1.262745362880036, "mean_action_processing_ms": 0.10600193278996024, "mean_env_wait_ms": 0.05229673986359844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044977664947509766, "StateBufferConnector_ms": 0.0036382675170898438, "ViewRequirementAgentConnector_ms": 0.25821805000305176}}, "episode_reward_max": 309.0, "episode_reward_min": 25.0, "episode_reward_mean": 76.15, "episode_len_mean": 76.15, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.0, 109.0, 29.0, 70.0, 49.0, 84.0, 50.0, 43.0, 43.0, 309.0, 80.0, 27.0, 25.0, 40.0, 80.0, 150.0, 33.0, 58.0, 90.0, 71.0], "episode_lengths": [83, 109, 29, 70, 49, 84, 50, 43, 43, 309, 80, 27, 25, 40, 80, 150, 33, 58, 90, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44882094140440787, "mean_inference_ms": 1.262745362880036, "mean_action_processing_ms": 0.10600193278996024, "mean_env_wait_ms": 0.05229673986359844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044977664947509766, "StateBufferConnector_ms": 0.0036382675170898438, "ViewRequirementAgentConnector_ms": 0.25821805000305176}, "num_agent_steps_sampled_this_iter": 1523, "num_env_steps_sampled_this_iter": 1523, "timesteps_this_iter": 1523, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 7.916384285701109}, "default_policy": {"total_loss": 7.916384285701109, "policy_loss": -0.022887407604461986, "vf_loss": 7.935463918551707, "vf_loss_unclipped": 199.94714122438737, "vf_explained_var": 0.1474805428529345, "entropy": 0.6383656073989136, "mean_kl_loss": 0.012692599196938568, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 118.0, "episode_reward_min": 8.0, "episode_reward_mean": 31.79527559055118, "episode_len_mean": 31.79527559055118, "episode_media": {}, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.0, 16.0, 13.0, 40.0, 49.0, 13.0, 33.0, 8.0, 26.0, 21.0, 60.0, 14.0, 12.0, 30.0, 10.0, 55.0, 40.0, 27.0, 58.0, 16.0, 34.0, 17.0, 26.0, 15.0, 18.0, 19.0, 88.0, 22.0, 49.0, 37.0, 19.0, 34.0, 41.0, 29.0, 24.0, 13.0, 48.0, 41.0, 48.0, 30.0, 34.0, 10.0, 24.0, 24.0, 28.0, 11.0, 44.0, 38.0, 21.0, 18.0, 22.0, 17.0, 9.0, 46.0, 23.0, 42.0, 36.0, 51.0, 26.0, 24.0, 67.0, 12.0, 25.0, 16.0, 28.0, 16.0, 26.0, 40.0, 16.0, 30.0, 64.0, 14.0, 42.0, 39.0, 20.0, 45.0, 14.0, 16.0, 40.0, 118.0, 18.0, 53.0, 31.0, 54.0, 52.0, 40.0, 26.0, 44.0, 53.0, 32.0, 26.0, 24.0, 29.0, 13.0, 29.0, 48.0, 73.0, 28.0, 29.0, 34.0, 31.0, 57.0, 31.0, 14.0, 31.0, 21.0, 15.0, 16.0, 36.0, 32.0, 16.0, 17.0, 23.0, 57.0, 14.0, 42.0, 24.0, 12.0, 15.0, 10.0, 46.0, 28.0, 39.0, 19.0, 54.0, 17.0, 71.0], "episode_lengths": [85, 16, 13, 40, 49, 13, 33, 8, 26, 21, 60, 14, 12, 30, 10, 55, 40, 27, 58, 16, 34, 17, 26, 15, 18, 19, 88, 22, 49, 37, 19, 34, 41, 29, 24, 13, 48, 41, 48, 30, 34, 10, 24, 24, 28, 11, 44, 38, 21, 18, 22, 17, 9, 46, 23, 42, 36, 51, 26, 24, 67, 12, 25, 16, 28, 16, 26, 40, 16, 30, 64, 14, 42, 39, 20, 45, 14, 16, 40, 118, 18, 53, 31, 54, 52, 40, 26, 44, 53, 32, 26, 24, 29, 13, 29, 48, 73, 28, 29, 34, 31, 57, 31, 14, 31, 21, 15, 16, 36, 32, 16, 17, 23, 57, 14, 42, 24, 12, 15, 10, 46, 28, 39, 19, 54, 17, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4723805693473952, "mean_inference_ms": 1.2685593747002026, "mean_action_processing_ms": 0.10535931858386482, "mean_env_wait_ms": 0.05059816765496172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004630389176015779, "StateBufferConnector_ms": 0.0036541871198519007, "ViewRequirementAgentConnector_ms": 0.2521843422116257}}, "episode_reward_max": 118.0, "episode_reward_min": 8.0, "episode_reward_mean": 31.79527559055118, "episode_len_mean": 31.79527559055118, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [85.0, 16.0, 13.0, 40.0, 49.0, 13.0, 33.0, 8.0, 26.0, 21.0, 60.0, 14.0, 12.0, 30.0, 10.0, 55.0, 40.0, 27.0, 58.0, 16.0, 34.0, 17.0, 26.0, 15.0, 18.0, 19.0, 88.0, 22.0, 49.0, 37.0, 19.0, 34.0, 41.0, 29.0, 24.0, 13.0, 48.0, 41.0, 48.0, 30.0, 34.0, 10.0, 24.0, 24.0, 28.0, 11.0, 44.0, 38.0, 21.0, 18.0, 22.0, 17.0, 9.0, 46.0, 23.0, 42.0, 36.0, 51.0, 26.0, 24.0, 67.0, 12.0, 25.0, 16.0, 28.0, 16.0, 26.0, 40.0, 16.0, 30.0, 64.0, 14.0, 42.0, 39.0, 20.0, 45.0, 14.0, 16.0, 40.0, 118.0, 18.0, 53.0, 31.0, 54.0, 52.0, 40.0, 26.0, 44.0, 53.0, 32.0, 26.0, 24.0, 29.0, 13.0, 29.0, 48.0, 73.0, 28.0, 29.0, 34.0, 31.0, 57.0, 31.0, 14.0, 31.0, 21.0, 15.0, 16.0, 36.0, 32.0, 16.0, 17.0, 23.0, 57.0, 14.0, 42.0, 24.0, 12.0, 15.0, 10.0, 46.0, 28.0, 39.0, 19.0, 54.0, 17.0, 71.0], "episode_lengths": [85, 16, 13, 40, 49, 13, 33, 8, 26, 21, 60, 14, 12, 30, 10, 55, 40, 27, 58, 16, 34, 17, 26, 15, 18, 19, 88, 22, 49, 37, 19, 34, 41, 29, 24, 13, 48, 41, 48, 30, 34, 10, 24, 24, 28, 11, 44, 38, 21, 18, 22, 17, 9, 46, 23, 42, 36, 51, 26, 24, 67, 12, 25, 16, 28, 16, 26, 40, 16, 30, 64, 14, 42, 39, 20, 45, 14, 16, 40, 118, 18, 53, 31, 54, 52, 40, 26, 44, 53, 32, 26, 24, 29, 13, 29, 48, 73, 28, 29, 34, 31, 57, 31, 14, 31, 21, 15, 16, 36, 32, 16, 17, 23, 57, 14, 42, 24, 12, 15, 10, 46, 28, 39, 19, 54, 17, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4723805693473952, "mean_inference_ms": 1.2685593747002026, "mean_action_processing_ms": 0.10535931858386482, "mean_env_wait_ms": 0.05059816765496172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004630389176015779, "StateBufferConnector_ms": 0.0036541871198519007, "ViewRequirementAgentConnector_ms": 0.2521843422116257}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 260.3791137511816, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 15369.591, "sample_time_ms": 7641.031, "synch_weights_time_ms": 2.429}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 310, "training_iteration": 2, "trial_id": "1b194_00000", "date": "2023-08-15_12-42-34", "timestamp": 1692103354, "time_this_iter_s": 18.246559143066406, "time_total_s": 33.63118505477905, "pid": 7305, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc6cfada170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 33.63118505477905, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.726923076923075, "ram_util_percent": 23.23461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.00331972758653}, "default_policy": {"total_loss": 9.00331972758653, "policy_loss": -0.014835133532514927, "vf_loss": 9.015465247351477, "vf_loss_unclipped": 772.7480672092072, "vf_explained_var": 0.07973359483899846, "entropy": 0.6176739112654729, "mean_kl_loss": 0.008965364331000609, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 213.0, "episode_reward_min": 10.0, "episode_reward_mean": 51.59, "episode_len_mean": 51.59, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 26.0, 24.0, 29.0, 13.0, 29.0, 48.0, 73.0, 28.0, 29.0, 34.0, 31.0, 57.0, 31.0, 14.0, 31.0, 21.0, 15.0, 16.0, 36.0, 32.0, 16.0, 17.0, 23.0, 57.0, 14.0, 42.0, 24.0, 12.0, 15.0, 10.0, 46.0, 28.0, 39.0, 19.0, 54.0, 17.0, 71.0, 80.0, 57.0, 57.0, 45.0, 48.0, 97.0, 136.0, 41.0, 19.0, 78.0, 149.0, 36.0, 55.0, 42.0, 44.0, 84.0, 53.0, 110.0, 112.0, 12.0, 46.0, 17.0, 83.0, 97.0, 13.0, 70.0, 28.0, 57.0, 127.0, 33.0, 78.0, 68.0, 85.0, 17.0, 213.0, 81.0, 61.0, 30.0, 30.0, 35.0, 75.0, 74.0, 48.0, 48.0, 53.0, 97.0, 89.0, 74.0, 37.0, 56.0, 73.0, 53.0, 109.0, 77.0, 22.0, 44.0, 51.0, 46.0, 63.0, 43.0, 45.0, 105.0], "episode_lengths": [32, 26, 24, 29, 13, 29, 48, 73, 28, 29, 34, 31, 57, 31, 14, 31, 21, 15, 16, 36, 32, 16, 17, 23, 57, 14, 42, 24, 12, 15, 10, 46, 28, 39, 19, 54, 17, 71, 80, 57, 57, 45, 48, 97, 136, 41, 19, 78, 149, 36, 55, 42, 44, 84, 53, 110, 112, 12, 46, 17, 83, 97, 13, 70, 28, 57, 127, 33, 78, 68, 85, 17, 213, 81, 61, 30, 30, 35, 75, 74, 48, 48, 53, 97, 89, 74, 37, 56, 73, 53, 109, 77, 22, 44, 51, 46, 63, 43, 45, 105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46701294039271013, "mean_inference_ms": 1.2686656032659656, "mean_action_processing_ms": 0.10539585103687146, "mean_env_wait_ms": 0.05048180165686123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004553318023681641, "StateBufferConnector_ms": 0.0035886764526367188, "ViewRequirementAgentConnector_ms": 0.2532768249511719}}, "episode_reward_max": 213.0, "episode_reward_min": 10.0, "episode_reward_mean": 51.59, "episode_len_mean": 51.59, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.0, 26.0, 24.0, 29.0, 13.0, 29.0, 48.0, 73.0, 28.0, 29.0, 34.0, 31.0, 57.0, 31.0, 14.0, 31.0, 21.0, 15.0, 16.0, 36.0, 32.0, 16.0, 17.0, 23.0, 57.0, 14.0, 42.0, 24.0, 12.0, 15.0, 10.0, 46.0, 28.0, 39.0, 19.0, 54.0, 17.0, 71.0, 80.0, 57.0, 57.0, 45.0, 48.0, 97.0, 136.0, 41.0, 19.0, 78.0, 149.0, 36.0, 55.0, 42.0, 44.0, 84.0, 53.0, 110.0, 112.0, 12.0, 46.0, 17.0, 83.0, 97.0, 13.0, 70.0, 28.0, 57.0, 127.0, 33.0, 78.0, 68.0, 85.0, 17.0, 213.0, 81.0, 61.0, 30.0, 30.0, 35.0, 75.0, 74.0, 48.0, 48.0, 53.0, 97.0, 89.0, 74.0, 37.0, 56.0, 73.0, 53.0, 109.0, 77.0, 22.0, 44.0, 51.0, 46.0, 63.0, 43.0, 45.0, 105.0], "episode_lengths": [32, 26, 24, 29, 13, 29, 48, 73, 28, 29, 34, 31, 57, 31, 14, 31, 21, 15, 16, 36, 32, 16, 17, 23, 57, 14, 42, 24, 12, 15, 10, 46, 28, 39, 19, 54, 17, 71, 80, 57, 57, 45, 48, 97, 136, 41, 19, 78, 149, 36, 55, 42, 44, 84, 53, 110, 112, 12, 46, 17, 83, 97, 13, 70, 28, 57, 127, 33, 78, 68, 85, 17, 213, 81, 61, 30, 30, 35, 75, 74, 48, 48, 53, 97, 89, 74, 37, 56, 73, 53, 109, 77, 22, 44, 51, 46, 63, 43, 45, 105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46701294039271013, "mean_inference_ms": 1.2686656032659656, "mean_action_processing_ms": 0.10539585103687146, "mean_env_wait_ms": 0.05048180165686123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004553318023681641, "StateBufferConnector_ms": 0.0035886764526367188, "ViewRequirementAgentConnector_ms": 0.2532768249511719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 261.6337569415796, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 15342.565, "sample_time_ms": 7605.159, "synch_weights_time_ms": 2.394}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 372, "training_iteration": 3, "trial_id": "1b194_00000", "date": "2023-08-15_12-42-49", "timestamp": 1692103369, "time_this_iter_s": 15.292119026184082, "time_total_s": 48.923304080963135, "pid": 7305, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc6cfada170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 48.923304080963135, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 29.645454545454548, "ram_util_percent": 23.390909090909087}}
{"evaluation": {"sampler_results": {"episode_reward_max": 460.0, "episode_reward_min": 55.0, "episode_reward_mean": 195.65, "episode_len_mean": 195.65, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [115.0, 55.0, 71.0, 136.0, 460.0, 237.0, 243.0, 206.0, 168.0, 187.0, 267.0, 125.0, 344.0, 184.0, 169.0, 347.0, 136.0, 104.0, 165.0, 194.0], "episode_lengths": [115, 55, 71, 136, 460, 237, 243, 206, 168, 187, 267, 125, 344, 184, 169, 347, 136, 104, 165, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43278628902354627, "mean_inference_ms": 1.25216508100242, "mean_action_processing_ms": 0.10283694496175835, "mean_env_wait_ms": 0.05039862681338514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004247426986694336, "StateBufferConnector_ms": 0.0033521652221679688, "ViewRequirementAgentConnector_ms": 0.24968862533569336}}, "episode_reward_max": 460.0, "episode_reward_min": 55.0, "episode_reward_mean": 195.65, "episode_len_mean": 195.65, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [115.0, 55.0, 71.0, 136.0, 460.0, 237.0, 243.0, 206.0, 168.0, 187.0, 267.0, 125.0, 344.0, 184.0, 169.0, 347.0, 136.0, 104.0, 165.0, 194.0], "episode_lengths": [115, 55, 71, 136, 460, 237, 243, 206, 168, 187, 267, 125, 344, 184, 169, 347, 136, 104, 165, 194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43278628902354627, "mean_inference_ms": 1.25216508100242, "mean_action_processing_ms": 0.10283694496175835, "mean_env_wait_ms": 0.05039862681338514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004247426986694336, "StateBufferConnector_ms": 0.0033521652221679688, "ViewRequirementAgentConnector_ms": 0.24968862533569336}, "num_agent_steps_sampled_this_iter": 3913, "num_env_steps_sampled_this_iter": 3913, "timesteps_this_iter": 3913, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.41142947943226}, "default_policy": {"total_loss": 9.41142947943226, "policy_loss": -0.012221963083280175, "vf_loss": 9.420879497202728, "vf_loss_unclipped": 1669.412771904138, "vf_explained_var": 0.06528552642254941, "entropy": 0.5967883744092384, "mean_kl_loss": 0.009239790021714926, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 360.0, "episode_reward_min": 12.0, "episode_reward_mean": 81.33, "episode_len_mean": 81.33, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 17.0, 71.0, 80.0, 57.0, 57.0, 45.0, 48.0, 97.0, 136.0, 41.0, 19.0, 78.0, 149.0, 36.0, 55.0, 42.0, 44.0, 84.0, 53.0, 110.0, 112.0, 12.0, 46.0, 17.0, 83.0, 97.0, 13.0, 70.0, 28.0, 57.0, 127.0, 33.0, 78.0, 68.0, 85.0, 17.0, 213.0, 81.0, 61.0, 30.0, 30.0, 35.0, 75.0, 74.0, 48.0, 48.0, 53.0, 97.0, 89.0, 74.0, 37.0, 56.0, 73.0, 53.0, 109.0, 77.0, 22.0, 44.0, 51.0, 46.0, 63.0, 43.0, 45.0, 105.0, 57.0, 76.0, 119.0, 36.0, 109.0, 128.0, 360.0, 82.0, 151.0, 101.0, 93.0, 109.0, 141.0, 127.0, 142.0, 26.0, 33.0, 46.0, 95.0, 113.0, 217.0, 129.0, 110.0, 183.0, 85.0, 35.0, 140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0], "episode_lengths": [54, 17, 71, 80, 57, 57, 45, 48, 97, 136, 41, 19, 78, 149, 36, 55, 42, 44, 84, 53, 110, 112, 12, 46, 17, 83, 97, 13, 70, 28, 57, 127, 33, 78, 68, 85, 17, 213, 81, 61, 30, 30, 35, 75, 74, 48, 48, 53, 97, 89, 74, 37, 56, 73, 53, 109, 77, 22, 44, 51, 46, 63, 43, 45, 105, 57, 76, 119, 36, 109, 128, 360, 82, 151, 101, 93, 109, 141, 127, 142, 26, 33, 46, 95, 113, 217, 129, 110, 183, 85, 35, 140, 105, 49, 127, 233, 174, 96, 121, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4614657756276264, "mean_inference_ms": 1.268390396813065, "mean_action_processing_ms": 0.10541663265805265, "mean_env_wait_ms": 0.05036342049875535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043714046478271484, "StateBufferConnector_ms": 0.0035920143127441406, "ViewRequirementAgentConnector_ms": 0.2534956932067871}}, "episode_reward_max": 360.0, "episode_reward_min": 12.0, "episode_reward_mean": 81.33, "episode_len_mean": 81.33, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.0, 17.0, 71.0, 80.0, 57.0, 57.0, 45.0, 48.0, 97.0, 136.0, 41.0, 19.0, 78.0, 149.0, 36.0, 55.0, 42.0, 44.0, 84.0, 53.0, 110.0, 112.0, 12.0, 46.0, 17.0, 83.0, 97.0, 13.0, 70.0, 28.0, 57.0, 127.0, 33.0, 78.0, 68.0, 85.0, 17.0, 213.0, 81.0, 61.0, 30.0, 30.0, 35.0, 75.0, 74.0, 48.0, 48.0, 53.0, 97.0, 89.0, 74.0, 37.0, 56.0, 73.0, 53.0, 109.0, 77.0, 22.0, 44.0, 51.0, 46.0, 63.0, 43.0, 45.0, 105.0, 57.0, 76.0, 119.0, 36.0, 109.0, 128.0, 360.0, 82.0, 151.0, 101.0, 93.0, 109.0, 141.0, 127.0, 142.0, 26.0, 33.0, 46.0, 95.0, 113.0, 217.0, 129.0, 110.0, 183.0, 85.0, 35.0, 140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0], "episode_lengths": [54, 17, 71, 80, 57, 57, 45, 48, 97, 136, 41, 19, 78, 149, 36, 55, 42, 44, 84, 53, 110, 112, 12, 46, 17, 83, 97, 13, 70, 28, 57, 127, 33, 78, 68, 85, 17, 213, 81, 61, 30, 30, 35, 75, 74, 48, 48, 53, 97, 89, 74, 37, 56, 73, 53, 109, 77, 22, 44, 51, 46, 63, 43, 45, 105, 57, 76, 119, 36, 109, 128, 360, 82, 151, 101, 93, 109, 141, 127, 142, 26, 33, 46, 95, 113, 217, 129, 110, 183, 85, 35, 140, 105, 49, 127, 233, 174, 96, 121, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4614657756276264, "mean_inference_ms": 1.268390396813065, "mean_action_processing_ms": 0.10541663265805265, "mean_env_wait_ms": 0.05036342049875535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043714046478271484, "StateBufferConnector_ms": 0.0035920143127441406, "ViewRequirementAgentConnector_ms": 0.2534956932067871}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.0628664568787, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 15293.893, "sample_time_ms": 7571.013, "synch_weights_time_ms": 2.455}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 407, "training_iteration": 4, "trial_id": "1b194_00000", "date": "2023-08-15_12-43-11", "timestamp": 1692103391, "time_this_iter_s": 22.348013877868652, "time_total_s": 71.27131795883179, "pid": 7305, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc6cfada170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 71.27131795883179, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 29.146874999999998, "ram_util_percent": 23.38125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.512348497346013}, "default_policy": {"total_loss": 9.512348497346013, "policy_loss": -0.01190982951220673, "vf_loss": 9.521520369596827, "vf_loss_unclipped": 2574.8980271719665, "vf_explained_var": 0.06931836175511895, "entropy": 0.5846030192969959, "mean_kl_loss": 0.009126478502866643, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 360.0, "episode_reward_min": 12.0, "episode_reward_mean": 107.4, "episode_len_mean": 107.4, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [112.0, 12.0, 46.0, 17.0, 83.0, 97.0, 13.0, 70.0, 28.0, 57.0, 127.0, 33.0, 78.0, 68.0, 85.0, 17.0, 213.0, 81.0, 61.0, 30.0, 30.0, 35.0, 75.0, 74.0, 48.0, 48.0, 53.0, 97.0, 89.0, 74.0, 37.0, 56.0, 73.0, 53.0, 109.0, 77.0, 22.0, 44.0, 51.0, 46.0, 63.0, 43.0, 45.0, 105.0, 57.0, 76.0, 119.0, 36.0, 109.0, 128.0, 360.0, 82.0, 151.0, 101.0, 93.0, 109.0, 141.0, 127.0, 142.0, 26.0, 33.0, 46.0, 95.0, 113.0, 217.0, 129.0, 110.0, 183.0, 85.0, 35.0, 140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0, 217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0], "episode_lengths": [112, 12, 46, 17, 83, 97, 13, 70, 28, 57, 127, 33, 78, 68, 85, 17, 213, 81, 61, 30, 30, 35, 75, 74, 48, 48, 53, 97, 89, 74, 37, 56, 73, 53, 109, 77, 22, 44, 51, 46, 63, 43, 45, 105, 57, 76, 119, 36, 109, 128, 360, 82, 151, 101, 93, 109, 141, 127, 142, 26, 33, 46, 95, 113, 217, 129, 110, 183, 85, 35, 140, 105, 49, 127, 233, 174, 96, 121, 37, 217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4585151733232881, "mean_inference_ms": 1.267859991414717, "mean_action_processing_ms": 0.10538385215543937, "mean_env_wait_ms": 0.05030753413375175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004243135452270508, "StateBufferConnector_ms": 0.0035457611083984375, "ViewRequirementAgentConnector_ms": 0.25086426734924316}}, "episode_reward_max": 360.0, "episode_reward_min": 12.0, "episode_reward_mean": 107.4, "episode_len_mean": 107.4, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [112.0, 12.0, 46.0, 17.0, 83.0, 97.0, 13.0, 70.0, 28.0, 57.0, 127.0, 33.0, 78.0, 68.0, 85.0, 17.0, 213.0, 81.0, 61.0, 30.0, 30.0, 35.0, 75.0, 74.0, 48.0, 48.0, 53.0, 97.0, 89.0, 74.0, 37.0, 56.0, 73.0, 53.0, 109.0, 77.0, 22.0, 44.0, 51.0, 46.0, 63.0, 43.0, 45.0, 105.0, 57.0, 76.0, 119.0, 36.0, 109.0, 128.0, 360.0, 82.0, 151.0, 101.0, 93.0, 109.0, 141.0, 127.0, 142.0, 26.0, 33.0, 46.0, 95.0, 113.0, 217.0, 129.0, 110.0, 183.0, 85.0, 35.0, 140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0, 217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0], "episode_lengths": [112, 12, 46, 17, 83, 97, 13, 70, 28, 57, 127, 33, 78, 68, 85, 17, 213, 81, 61, 30, 30, 35, 75, 74, 48, 48, 53, 97, 89, 74, 37, 56, 73, 53, 109, 77, 22, 44, 51, 46, 63, 43, 45, 105, 57, 76, 119, 36, 109, 128, 360, 82, 151, 101, 93, 109, 141, 127, 142, 26, 33, 46, 95, 113, 217, 129, 110, 183, 85, 35, 140, 105, 49, 127, 233, 174, 96, 121, 37, 217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4585151733232881, "mean_inference_ms": 1.267859991414717, "mean_action_processing_ms": 0.10538385215543937, "mean_env_wait_ms": 0.05030753413375175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004243135452270508, "StateBufferConnector_ms": 0.0035457611083984375, "ViewRequirementAgentConnector_ms": 0.25086426734924316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 263.99893073705783, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 15265.424, "sample_time_ms": 7540.528, "synch_weights_time_ms": 2.471}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 428, "training_iteration": 5, "trial_id": "1b194_00000", "date": "2023-08-15_12-43-27", "timestamp": 1692103407, "time_this_iter_s": 15.15531587600708, "time_total_s": 86.42663383483887, "pid": 7305, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc6cfada170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 86.42663383483887, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.672727272727283, "ram_util_percent": 23.427272727272722}}
{"evaluation": {"sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 101.0, "episode_reward_mean": 424.9, "episode_len_mean": 424.9, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 101.0, 500.0, 500.0, 500.0, 500.0, 345.0, 500.0, 293.0, 500.0, 500.0, 247.0, 500.0, 500.0, 500.0, 289.0, 223.0, 500.0, 500.0], "episode_lengths": [500, 500, 101, 500, 500, 500, 500, 345, 500, 293, 500, 500, 247, 500, 500, 500, 289, 223, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43294591462265686, "mean_inference_ms": 1.2580231350726623, "mean_action_processing_ms": 0.10263845404716303, "mean_env_wait_ms": 0.05024294721468572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004150867462158203, "StateBufferConnector_ms": 0.003377199172973633, "ViewRequirementAgentConnector_ms": 0.25721192359924316}}, "episode_reward_max": 500.0, "episode_reward_min": 101.0, "episode_reward_mean": 424.9, "episode_len_mean": 424.9, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 101.0, 500.0, 500.0, 500.0, 500.0, 345.0, 500.0, 293.0, 500.0, 500.0, 247.0, 500.0, 500.0, 500.0, 289.0, 223.0, 500.0, 500.0], "episode_lengths": [500, 500, 101, 500, 500, 500, 500, 345, 500, 293, 500, 500, 247, 500, 500, 500, 289, 223, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43294591462265686, "mean_inference_ms": 1.2580231350726623, "mean_action_processing_ms": 0.10263845404716303, "mean_env_wait_ms": 0.05024294721468572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004150867462158203, "StateBufferConnector_ms": 0.003377199172973633, "ViewRequirementAgentConnector_ms": 0.25721192359924316}, "num_agent_steps_sampled_this_iter": 8498, "num_env_steps_sampled_this_iter": 8498, "timesteps_this_iter": 8498, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.810813972944898}, "default_policy": {"total_loss": 9.810813972944898, "policy_loss": -0.003951145001927387, "vf_loss": 9.814136727786522, "vf_loss_unclipped": 4039.64969997772, "vf_explained_var": -0.168661194950787, "entropy": 0.5846401116868326, "mean_kl_loss": 0.002094508843818399, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.15000000596046448}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 17.0, "episode_reward_mean": 138.24, "episode_len_mean": 138.24, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [127.0, 33.0, 78.0, 68.0, 85.0, 17.0, 213.0, 81.0, 61.0, 30.0, 30.0, 35.0, 75.0, 74.0, 48.0, 48.0, 53.0, 97.0, 89.0, 74.0, 37.0, 56.0, 73.0, 53.0, 109.0, 77.0, 22.0, 44.0, 51.0, 46.0, 63.0, 43.0, 45.0, 105.0, 57.0, 76.0, 119.0, 36.0, 109.0, 128.0, 360.0, 82.0, 151.0, 101.0, 93.0, 109.0, 141.0, 127.0, 142.0, 26.0, 33.0, 46.0, 95.0, 113.0, 217.0, 129.0, 110.0, 183.0, 85.0, 35.0, 140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0, 217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0], "episode_lengths": [127, 33, 78, 68, 85, 17, 213, 81, 61, 30, 30, 35, 75, 74, 48, 48, 53, 97, 89, 74, 37, 56, 73, 53, 109, 77, 22, 44, 51, 46, 63, 43, 45, 105, 57, 76, 119, 36, 109, 128, 360, 82, 151, 101, 93, 109, 141, 127, 142, 26, 33, 46, 95, 113, 217, 129, 110, 183, 85, 35, 140, 105, 49, 127, 233, 174, 96, 121, 37, 217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568473697461226, "mean_inference_ms": 1.267494964377097, "mean_action_processing_ms": 0.10536343161670908, "mean_env_wait_ms": 0.05027751494580091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043604373931884766, "StateBufferConnector_ms": 0.003554105758666992, "ViewRequirementAgentConnector_ms": 0.2519550323486328}}, "episode_reward_max": 500.0, "episode_reward_min": 17.0, "episode_reward_mean": 138.24, "episode_len_mean": 138.24, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [127.0, 33.0, 78.0, 68.0, 85.0, 17.0, 213.0, 81.0, 61.0, 30.0, 30.0, 35.0, 75.0, 74.0, 48.0, 48.0, 53.0, 97.0, 89.0, 74.0, 37.0, 56.0, 73.0, 53.0, 109.0, 77.0, 22.0, 44.0, 51.0, 46.0, 63.0, 43.0, 45.0, 105.0, 57.0, 76.0, 119.0, 36.0, 109.0, 128.0, 360.0, 82.0, 151.0, 101.0, 93.0, 109.0, 141.0, 127.0, 142.0, 26.0, 33.0, 46.0, 95.0, 113.0, 217.0, 129.0, 110.0, 183.0, 85.0, 35.0, 140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0, 217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0], "episode_lengths": [127, 33, 78, 68, 85, 17, 213, 81, 61, 30, 30, 35, 75, 74, 48, 48, 53, 97, 89, 74, 37, 56, 73, 53, 109, 77, 22, 44, 51, 46, 63, 43, 45, 105, 57, 76, 119, 36, 109, 128, 360, 82, 151, 101, 93, 109, 141, 127, 142, 26, 33, 46, 95, 113, 217, 129, 110, 183, 85, 35, 140, 105, 49, 127, 233, 174, 96, 121, 37, 217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4568473697461226, "mean_inference_ms": 1.267494964377097, "mean_action_processing_ms": 0.10536343161670908, "mean_env_wait_ms": 0.05027751494580091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043604373931884766, "StateBufferConnector_ms": 0.003554105758666992, "ViewRequirementAgentConnector_ms": 0.2519550323486328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.7236199965896, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 24000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 15239.53, "sample_time_ms": 7519.943, "synch_weights_time_ms": 2.463}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 438, "training_iteration": 6, "trial_id": "1b194_00000", "date": "2023-08-15_12-43-58", "timestamp": 1692103438, "time_this_iter_s": 30.916423559188843, "time_total_s": 117.34305739402771, "pid": 7305, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc6cfada170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 117.34305739402771, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 29.447727272727267, "ram_util_percent": 23.50454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.81673025017354}, "default_policy": {"total_loss": 9.81673025017354, "policy_loss": -0.0036776462264025388, "vf_loss": 9.819564449253367, "vf_loss_unclipped": 3761.0569944727395, "vf_explained_var": -0.19973163964397617, "entropy": 0.5778239238490936, "mean_kl_loss": 0.005622790768116298, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.15000000596046448}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 22.0, "episode_reward_mean": 173.2, "episode_len_mean": 173.2, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 75.0, 74.0, 48.0, 48.0, 53.0, 97.0, 89.0, 74.0, 37.0, 56.0, 73.0, 53.0, 109.0, 77.0, 22.0, 44.0, 51.0, 46.0, 63.0, 43.0, 45.0, 105.0, 57.0, 76.0, 119.0, 36.0, 109.0, 128.0, 360.0, 82.0, 151.0, 101.0, 93.0, 109.0, 141.0, 127.0, 142.0, 26.0, 33.0, 46.0, 95.0, 113.0, 217.0, 129.0, 110.0, 183.0, 85.0, 35.0, 140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0, 217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0], "episode_lengths": [35, 75, 74, 48, 48, 53, 97, 89, 74, 37, 56, 73, 53, 109, 77, 22, 44, 51, 46, 63, 43, 45, 105, 57, 76, 119, 36, 109, 128, 360, 82, 151, 101, 93, 109, 141, 127, 142, 26, 33, 46, 95, 113, 217, 129, 110, 183, 85, 35, 140, 105, 49, 127, 233, 174, 96, 121, 37, 217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45466590382882816, "mean_inference_ms": 1.266989783823084, "mean_action_processing_ms": 0.10534090756676211, "mean_env_wait_ms": 0.05024007197032804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004376411437988281, "StateBufferConnector_ms": 0.0035719871520996094, "ViewRequirementAgentConnector_ms": 0.25219154357910156}}, "episode_reward_max": 500.0, "episode_reward_min": 22.0, "episode_reward_mean": 173.2, "episode_len_mean": 173.2, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.0, 75.0, 74.0, 48.0, 48.0, 53.0, 97.0, 89.0, 74.0, 37.0, 56.0, 73.0, 53.0, 109.0, 77.0, 22.0, 44.0, 51.0, 46.0, 63.0, 43.0, 45.0, 105.0, 57.0, 76.0, 119.0, 36.0, 109.0, 128.0, 360.0, 82.0, 151.0, 101.0, 93.0, 109.0, 141.0, 127.0, 142.0, 26.0, 33.0, 46.0, 95.0, 113.0, 217.0, 129.0, 110.0, 183.0, 85.0, 35.0, 140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0, 217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0], "episode_lengths": [35, 75, 74, 48, 48, 53, 97, 89, 74, 37, 56, 73, 53, 109, 77, 22, 44, 51, 46, 63, 43, 45, 105, 57, 76, 119, 36, 109, 128, 360, 82, 151, 101, 93, 109, 141, 127, 142, 26, 33, 46, 95, 113, 217, 129, 110, 183, 85, 35, 140, 105, 49, 127, 233, 174, 96, 121, 37, 217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45466590382882816, "mean_inference_ms": 1.266989783823084, "mean_action_processing_ms": 0.10534090756676211, "mean_env_wait_ms": 0.05024007197032804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004376411437988281, "StateBufferConnector_ms": 0.0035719871520996094, "ViewRequirementAgentConnector_ms": 0.25219154357910156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 263.97220965558796, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 28000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 15227.179, "sample_time_ms": 7503.076, "synch_weights_time_ms": 2.467}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 449, "training_iteration": 7, "trial_id": "1b194_00000", "date": "2023-08-15_12-44-13", "timestamp": 1692103453, "time_this_iter_s": 15.1560537815094, "time_total_s": 132.4991111755371, "pid": 7305, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc6cfada170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 132.4991111755371, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 29.447619047619046, "ram_util_percent": 23.514285714285716}}
{"evaluation": {"sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 62.0, "episode_reward_mean": 433.85, "episode_len_mean": 433.85, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 220.0, 288.0, 500.0, 500.0, 107.0, 62.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 220, 288, 500, 500, 107, 62, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43150279114104234, "mean_inference_ms": 1.2585257884993417, "mean_action_processing_ms": 0.10248732402348718, "mean_env_wait_ms": 0.05016710912993624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046384334564208984, "StateBufferConnector_ms": 0.0033903121948242188, "ViewRequirementAgentConnector_ms": 0.25710344314575195}}, "episode_reward_max": 500.0, "episode_reward_min": 62.0, "episode_reward_mean": 433.85, "episode_len_mean": 433.85, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 220.0, 288.0, 500.0, 500.0, 107.0, 62.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 220, 288, 500, 500, 107, 62, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43150279114104234, "mean_inference_ms": 1.2585257884993417, "mean_action_processing_ms": 0.10248732402348718, "mean_env_wait_ms": 0.05016710912993624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046384334564208984, "StateBufferConnector_ms": 0.0033903121948242188, "ViewRequirementAgentConnector_ms": 0.25710344314575195}, "num_agent_steps_sampled_this_iter": 8677, "num_env_steps_sampled_this_iter": 8677, "timesteps_this_iter": 8677, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.869492711797198}, "default_policy": {"total_loss": 9.869492711797198, "policy_loss": -0.0032428262530883618, "vf_loss": 9.872063967210652, "vf_loss_unclipped": 3760.936761721873, "vf_explained_var": -0.28251214493820664, "entropy": 0.5997528364536351, "mean_kl_loss": 0.004477100527978359, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 22.0, "episode_reward_mean": 207.21, "episode_len_mean": 207.21, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.0, 37.0, 56.0, 73.0, 53.0, 109.0, 77.0, 22.0, 44.0, 51.0, 46.0, 63.0, 43.0, 45.0, 105.0, 57.0, 76.0, 119.0, 36.0, 109.0, 128.0, 360.0, 82.0, 151.0, 101.0, 93.0, 109.0, 141.0, 127.0, 142.0, 26.0, 33.0, 46.0, 95.0, 113.0, 217.0, 129.0, 110.0, 183.0, 85.0, 35.0, 140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0, 217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [74, 37, 56, 73, 53, 109, 77, 22, 44, 51, 46, 63, 43, 45, 105, 57, 76, 119, 36, 109, 128, 360, 82, 151, 101, 93, 109, 141, 127, 142, 26, 33, 46, 95, 113, 217, 129, 110, 183, 85, 35, 140, 105, 49, 127, 233, 174, 96, 121, 37, 217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4529010783578601, "mean_inference_ms": 1.2665952307318196, "mean_action_processing_ms": 0.10532731332064449, "mean_env_wait_ms": 0.05021121730672701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042994022369384766, "StateBufferConnector_ms": 0.0035734176635742188, "ViewRequirementAgentConnector_ms": 0.2525651454925537}}, "episode_reward_max": 500.0, "episode_reward_min": 22.0, "episode_reward_mean": 207.21, "episode_len_mean": 207.21, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [74.0, 37.0, 56.0, 73.0, 53.0, 109.0, 77.0, 22.0, 44.0, 51.0, 46.0, 63.0, 43.0, 45.0, 105.0, 57.0, 76.0, 119.0, 36.0, 109.0, 128.0, 360.0, 82.0, 151.0, 101.0, 93.0, 109.0, 141.0, 127.0, 142.0, 26.0, 33.0, 46.0, 95.0, 113.0, 217.0, 129.0, 110.0, 183.0, 85.0, 35.0, 140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0, 217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [74, 37, 56, 73, 53, 109, 77, 22, 44, 51, 46, 63, 43, 45, 105, 57, 76, 119, 36, 109, 128, 360, 82, 151, 101, 93, 109, 141, 127, 142, 26, 33, 46, 95, 113, 217, 129, 110, 183, 85, 35, 140, 105, 49, 127, 233, 174, 96, 121, 37, 217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4529010783578601, "mean_inference_ms": 1.2665952307318196, "mean_action_processing_ms": 0.10532731332064449, "mean_env_wait_ms": 0.05021121730672701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042994022369384766, "StateBufferConnector_ms": 0.0035734176635742188, "ViewRequirementAgentConnector_ms": 0.2525651454925537}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 263.9763879724799, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 32000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 15217.887, "sample_time_ms": 7492.622, "synch_weights_time_ms": 2.423}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 457, "training_iteration": 8, "trial_id": "1b194_00000", "date": "2023-08-15_12-44-44", "timestamp": 1692103484, "time_this_iter_s": 31.23358702659607, "time_total_s": 163.73269820213318, "pid": 7305, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc6cfada170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 163.73269820213318, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 29.488888888888894, "ram_util_percent": 23.511111111111113}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.87851548855747}, "default_policy": {"total_loss": 9.87851548855747, "policy_loss": -0.00279231180847962, "vf_loss": 9.881027194228508, "vf_loss_unclipped": 3362.259446003798, "vf_explained_var": -0.30174753374890734, "entropy": 0.584754293852015, "mean_kl_loss": 0.0037411404745944505, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.03750000149011612}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 26.0, "episode_reward_mean": 239.72, "episode_len_mean": 239.72, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 51.0, 46.0, 63.0, 43.0, 45.0, 105.0, 57.0, 76.0, 119.0, 36.0, 109.0, 128.0, 360.0, 82.0, 151.0, 101.0, 93.0, 109.0, 141.0, 127.0, 142.0, 26.0, 33.0, 46.0, 95.0, 113.0, 217.0, 129.0, 110.0, 183.0, 85.0, 35.0, 140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0, 217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0], "episode_lengths": [44, 51, 46, 63, 43, 45, 105, 57, 76, 119, 36, 109, 128, 360, 82, 151, 101, 93, 109, 141, 127, 142, 26, 33, 46, 95, 113, 217, 129, 110, 183, 85, 35, 140, 105, 49, 127, 233, 174, 96, 121, 37, 217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45100981352084946, "mean_inference_ms": 1.2661985221816556, "mean_action_processing_ms": 0.10531422255047447, "mean_env_wait_ms": 0.050186546370581266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042877197265625, "StateBufferConnector_ms": 0.0035521984100341797, "ViewRequirementAgentConnector_ms": 0.2520732879638672}}, "episode_reward_max": 500.0, "episode_reward_min": 26.0, "episode_reward_mean": 239.72, "episode_len_mean": 239.72, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.0, 51.0, 46.0, 63.0, 43.0, 45.0, 105.0, 57.0, 76.0, 119.0, 36.0, 109.0, 128.0, 360.0, 82.0, 151.0, 101.0, 93.0, 109.0, 141.0, 127.0, 142.0, 26.0, 33.0, 46.0, 95.0, 113.0, 217.0, 129.0, 110.0, 183.0, 85.0, 35.0, 140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0, 217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0], "episode_lengths": [44, 51, 46, 63, 43, 45, 105, 57, 76, 119, 36, 109, 128, 360, 82, 151, 101, 93, 109, 141, 127, 142, 26, 33, 46, 95, 113, 217, 129, 110, 183, 85, 35, 140, 105, 49, 127, 233, 174, 96, 121, 37, 217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45100981352084946, "mean_inference_ms": 1.2661985221816556, "mean_action_processing_ms": 0.10531422255047447, "mean_env_wait_ms": 0.050186546370581266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042877197265625, "StateBufferConnector_ms": 0.0035521984100341797, "ViewRequirementAgentConnector_ms": 0.2520732879638672}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 263.75176896680074, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 36000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 15212.093, "sample_time_ms": 7486.415, "synch_weights_time_ms": 2.443}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 465, "training_iteration": 9, "trial_id": "1b194_00000", "date": "2023-08-15_12-44-59", "timestamp": 1692103499, "time_this_iter_s": 15.168524026870728, "time_total_s": 178.9012222290039, "pid": 7305, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc6cfada170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 178.9012222290039, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 29.34545454545454, "ram_util_percent": 23.518181818181823}}
{"evaluation": {"sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 290.0, "episode_reward_mean": 489.5, "episode_len_mean": 489.5, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 290.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 290, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4305704810959153, "mean_inference_ms": 1.2597563634514186, "mean_action_processing_ms": 0.10251851738488908, "mean_env_wait_ms": 0.05014990076710578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042569637298583984, "StateBufferConnector_ms": 0.00339508056640625, "ViewRequirementAgentConnector_ms": 0.2586531639099121}}, "episode_reward_max": 500.0, "episode_reward_min": 290.0, "episode_reward_mean": 489.5, "episode_len_mean": 489.5, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 290.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 290, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4305704810959153, "mean_inference_ms": 1.2597563634514186, "mean_action_processing_ms": 0.10251851738488908, "mean_env_wait_ms": 0.05014990076710578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042569637298583984, "StateBufferConnector_ms": 0.00339508056640625, "ViewRequirementAgentConnector_ms": 0.2586531639099121}, "num_agent_steps_sampled_this_iter": 9790, "num_env_steps_sampled_this_iter": 9790, "timesteps_this_iter": 9790, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.83107677248241}, "default_policy": {"total_loss": 9.83107677248241, "policy_loss": -0.004832139506793098, "vf_loss": 9.835666550756264, "vf_loss_unclipped": 2868.4505403433272, "vf_explained_var": -0.20102981991096855, "entropy": 0.5609780761605895, "mean_kl_loss": 0.006462685423048945, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.03750000149011612}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 26.0, "episode_reward_mean": 277.24, "episode_len_mean": 277.24, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [119.0, 36.0, 109.0, 128.0, 360.0, 82.0, 151.0, 101.0, 93.0, 109.0, 141.0, 127.0, 142.0, 26.0, 33.0, 46.0, 95.0, 113.0, 217.0, 129.0, 110.0, 183.0, 85.0, 35.0, 140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0, 217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 425.0, 500.0, 496.0], "episode_lengths": [119, 36, 109, 128, 360, 82, 151, 101, 93, 109, 141, 127, 142, 26, 33, 46, 95, 113, 217, 129, 110, 183, 85, 35, 140, 105, 49, 127, 233, 174, 96, 121, 37, 217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 361, 500, 500, 425, 500, 496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44893006477519587, "mean_inference_ms": 1.2657167188390035, "mean_action_processing_ms": 0.10529592648943104, "mean_env_wait_ms": 0.05015823969312503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004267692565917969, "StateBufferConnector_ms": 0.003563404083251953, "ViewRequirementAgentConnector_ms": 0.25287961959838867}}, "episode_reward_max": 500.0, "episode_reward_min": 26.0, "episode_reward_mean": 277.24, "episode_len_mean": 277.24, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [119.0, 36.0, 109.0, 128.0, 360.0, 82.0, 151.0, 101.0, 93.0, 109.0, 141.0, 127.0, 142.0, 26.0, 33.0, 46.0, 95.0, 113.0, 217.0, 129.0, 110.0, 183.0, 85.0, 35.0, 140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0, 217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 425.0, 500.0, 496.0], "episode_lengths": [119, 36, 109, 128, 360, 82, 151, 101, 93, 109, 141, 127, 142, 26, 33, 46, 95, 113, 217, 129, 110, 183, 85, 35, 140, 105, 49, 127, 233, 174, 96, 121, 37, 217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 361, 500, 500, 425, 500, 496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44893006477519587, "mean_inference_ms": 1.2657167188390035, "mean_action_processing_ms": 0.10529592648943104, "mean_env_wait_ms": 0.05015823969312503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004267692565917969, "StateBufferConnector_ms": 0.003563404083251953, "ViewRequirementAgentConnector_ms": 0.25287961959838867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.19688409479016, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 40000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 15204.903, "sample_time_ms": 7479.28, "synch_weights_time_ms": 2.446}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 474, "training_iteration": 10, "trial_id": "1b194_00000", "date": "2023-08-15_12-45-33", "timestamp": 1692103533, "time_this_iter_s": 33.30986952781677, "time_total_s": 212.21109175682068, "pid": 7305, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc6cfada170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 212.21109175682068, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 28.927659574468084, "ram_util_percent": 23.54042553191489}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.861078721882183}, "default_policy": {"total_loss": 9.861078721882183, "policy_loss": -0.0023462263890095293, "vf_loss": 9.863286047856182, "vf_loss_unclipped": 2639.122988507692, "vf_explained_var": -0.19013786760728751, "entropy": 0.5616395896050468, "mean_kl_loss": 0.003704388354000659, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.01875000074505806}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 26.0, "episode_reward_mean": 304.75, "episode_len_mean": 304.75, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.0, 109.0, 141.0, 127.0, 142.0, 26.0, 33.0, 46.0, 95.0, 113.0, 217.0, 129.0, 110.0, 183.0, 85.0, 35.0, 140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0, 217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 425.0, 500.0, 496.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0], "episode_lengths": [93, 109, 141, 127, 142, 26, 33, 46, 95, 113, 217, 129, 110, 183, 85, 35, 140, 105, 49, 127, 233, 174, 96, 121, 37, 217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 361, 500, 500, 425, 500, 496, 500, 500, 500, 500, 337, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4474394219062154, "mean_inference_ms": 1.2653092284811431, "mean_action_processing_ms": 0.10528262022898545, "mean_env_wait_ms": 0.05014102644045368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004266500473022461, "StateBufferConnector_ms": 0.003565549850463867, "ViewRequirementAgentConnector_ms": 0.2528841495513916}}, "episode_reward_max": 500.0, "episode_reward_min": 26.0, "episode_reward_mean": 304.75, "episode_len_mean": 304.75, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [93.0, 109.0, 141.0, 127.0, 142.0, 26.0, 33.0, 46.0, 95.0, 113.0, 217.0, 129.0, 110.0, 183.0, 85.0, 35.0, 140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0, 217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 425.0, 500.0, 496.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0], "episode_lengths": [93, 109, 141, 127, 142, 26, 33, 46, 95, 113, 217, 129, 110, 183, 85, 35, 140, 105, 49, 127, 233, 174, 96, 121, 37, 217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 361, 500, 500, 425, 500, 496, 500, 500, 500, 500, 337, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4474394219062154, "mean_inference_ms": 1.2653092284811431, "mean_action_processing_ms": 0.10528262022898545, "mean_env_wait_ms": 0.05014102644045368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004266500473022461, "StateBufferConnector_ms": 0.003565549850463867, "ViewRequirementAgentConnector_ms": 0.2528841495513916}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 265.74421543337064, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 44000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 15172.407, "sample_time_ms": 7451.092, "synch_weights_time_ms": 2.46}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 482, "training_iteration": 11, "trial_id": "1b194_00000", "date": "2023-08-15_12-45-48", "timestamp": 1692103548, "time_this_iter_s": 15.055428266525269, "time_total_s": 227.26652002334595, "pid": 7305, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc6cfada170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 227.26652002334595, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 28.9, "ram_util_percent": 23.53333333333333}}
{"evaluation": {"sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 99.0, "episode_reward_mean": 464.1, "episode_len_mean": 464.1, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 99.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 488.0, 500.0, 500.0, 500.0, 500.0, 500.0, 195.0], "episode_lengths": [500, 500, 500, 500, 500, 99, 500, 500, 500, 500, 500, 500, 500, 488, 500, 500, 500, 500, 500, 195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4303262371234914, "mean_inference_ms": 1.2600765543081929, "mean_action_processing_ms": 0.10242660973811261, "mean_env_wait_ms": 0.05011751399869803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007755756378173828, "StateBufferConnector_ms": 0.0033783912658691406, "ViewRequirementAgentConnector_ms": 0.2494657039642334}}, "episode_reward_max": 500.0, "episode_reward_min": 99.0, "episode_reward_mean": 464.1, "episode_len_mean": 464.1, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 99.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 488.0, 500.0, 500.0, 500.0, 500.0, 500.0, 195.0], "episode_lengths": [500, 500, 500, 500, 500, 99, 500, 500, 500, 500, 500, 500, 500, 488, 500, 500, 500, 500, 500, 195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4303262371234914, "mean_inference_ms": 1.2600765543081929, "mean_action_processing_ms": 0.10242660973811261, "mean_env_wait_ms": 0.05011751399869803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007755756378173828, "StateBufferConnector_ms": 0.0033783912658691406, "ViewRequirementAgentConnector_ms": 0.2494657039642334}, "num_agent_steps_sampled_this_iter": 9282, "num_env_steps_sampled_this_iter": 9282, "timesteps_this_iter": 9282, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.847561949097525}, "default_policy": {"total_loss": 9.847561949097525, "policy_loss": -0.0030106538668401967, "vf_loss": 9.850331055330061, "vf_loss_unclipped": 2359.0873782029794, "vf_explained_var": -0.09387564404941062, "entropy": 0.5621652908797966, "mean_kl_loss": 0.012883149802279096, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.01875000074505806}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 35.0, "episode_reward_mean": 337.58, "episode_len_mean": 337.58, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.0, 113.0, 217.0, 129.0, 110.0, 183.0, 85.0, 35.0, 140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0, 217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 425.0, 500.0, 496.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [95, 113, 217, 129, 110, 183, 85, 35, 140, 105, 49, 127, 233, 174, 96, 121, 37, 217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 361, 500, 500, 425, 500, 496, 500, 500, 500, 500, 337, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4458928851216813, "mean_inference_ms": 1.264889678876014, "mean_action_processing_ms": 0.1052717602172022, "mean_env_wait_ms": 0.050122103794801726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004227876663208008, "StateBufferConnector_ms": 0.003574371337890625, "ViewRequirementAgentConnector_ms": 0.2546975612640381}}, "episode_reward_max": 500.0, "episode_reward_min": 35.0, "episode_reward_mean": 337.58, "episode_len_mean": 337.58, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [95.0, 113.0, 217.0, 129.0, 110.0, 183.0, 85.0, 35.0, 140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0, 217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 425.0, 500.0, 496.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [95, 113, 217, 129, 110, 183, 85, 35, 140, 105, 49, 127, 233, 174, 96, 121, 37, 217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 361, 500, 500, 425, 500, 496, 500, 500, 500, 500, 337, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4458928851216813, "mean_inference_ms": 1.264889678876014, "mean_action_processing_ms": 0.1052717602172022, "mean_env_wait_ms": 0.050122103794801726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004227876663208008, "StateBufferConnector_ms": 0.003574371337890625, "ViewRequirementAgentConnector_ms": 0.2546975612640381}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 263.6385670365301, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 48000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 15153.415, "sample_time_ms": 7435.368, "synch_weights_time_ms": 2.452}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 490, "training_iteration": 12, "trial_id": "1b194_00000", "date": "2023-08-15_12-46-20", "timestamp": 1692103580, "time_this_iter_s": 32.391499757766724, "time_total_s": 259.65801978111267, "pid": 7305, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc6cfada170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 259.65801978111267, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 29.470212765957445, "ram_util_percent": 23.557446808510633}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.835329026301533}, "default_policy": {"total_loss": 9.835329026301533, "policy_loss": -0.004683651458988311, "vf_loss": 9.839758565939311, "vf_loss_unclipped": 2071.4019658916286, "vf_explained_var": -0.055954064006236065, "entropy": 0.577095208391706, "mean_kl_loss": 0.013551661856053951, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.01875000074505806}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 367.91, "episode_len_mean": 367.91, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0, 217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 425.0, 500.0, 496.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [140, 105, 49, 127, 233, 174, 96, 121, 37, 217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 361, 500, 500, 425, 500, 496, 500, 500, 500, 500, 337, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.444314119250642, "mean_inference_ms": 1.2644492505452503, "mean_action_processing_ms": 0.10526062448845827, "mean_env_wait_ms": 0.05010228051929884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041849613189697266, "StateBufferConnector_ms": 0.0035648345947265625, "ViewRequirementAgentConnector_ms": 0.25498366355895996}}, "episode_reward_max": 500.0, "episode_reward_min": 37.0, "episode_reward_mean": 367.91, "episode_len_mean": 367.91, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [140.0, 105.0, 49.0, 127.0, 233.0, 174.0, 96.0, 121.0, 37.0, 217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 425.0, 500.0, 496.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [140, 105, 49, 127, 233, 174, 96, 121, 37, 217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 361, 500, 500, 425, 500, 496, 500, 500, 500, 500, 337, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.444314119250642, "mean_inference_ms": 1.2644492505452503, "mean_action_processing_ms": 0.10526062448845827, "mean_env_wait_ms": 0.05010228051929884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041849613189697266, "StateBufferConnector_ms": 0.0035648345947265625, "ViewRequirementAgentConnector_ms": 0.25498366355895996}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.5989407031267, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 52000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 15136.282, "sample_time_ms": 7425.314, "synch_weights_time_ms": 2.468}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 498, "training_iteration": 13, "trial_id": "1b194_00000", "date": "2023-08-15_12-46-35", "timestamp": 1692103595, "time_this_iter_s": 15.120330572128296, "time_total_s": 274.77835035324097, "pid": 7305, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc6cfada170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 274.77835035324097, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 29.133333333333333, "ram_util_percent": 23.547619047619047}}
{"evaluation": {"sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 500.0, "episode_reward_mean": 500.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4304066068588622, "mean_inference_ms": 1.2629174999791803, "mean_action_processing_ms": 0.10243177912145027, "mean_env_wait_ms": 0.050111785133172285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005664825439453125, "StateBufferConnector_ms": 0.0034332275390625, "ViewRequirementAgentConnector_ms": 0.2577805519104004}}, "episode_reward_max": 500.0, "episode_reward_min": 500.0, "episode_reward_mean": 500.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4304066068588622, "mean_inference_ms": 1.2629174999791803, "mean_action_processing_ms": 0.10243177912145027, "mean_env_wait_ms": 0.050111785133172285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005664825439453125, "StateBufferConnector_ms": 0.0034332275390625, "ViewRequirementAgentConnector_ms": 0.2577805519104004}, "num_agent_steps_sampled_this_iter": 10000, "num_env_steps_sampled_this_iter": 10000, "timesteps_this_iter": 10000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.801376755557843}, "default_policy": {"total_loss": 9.801376755557843, "policy_loss": -0.0077041645429091156, "vf_loss": 9.80882601341459, "vf_loss_unclipped": 1704.5239480675411, "vf_explained_var": -0.026108898651371126, "entropy": 0.5351683483449127, "mean_kl_loss": 0.01359474030891276, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.01875000074505806}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 59.0, "episode_reward_mean": 398.71, "episode_len_mean": 398.71, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 425.0, 500.0, 496.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 424.0, 500.0, 238.0, 500.0, 500.0, 500.0], "episode_lengths": [217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 361, 500, 500, 425, 500, 496, 500, 500, 500, 500, 337, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 238, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4424604342425282, "mean_inference_ms": 1.2639063529966217, "mean_action_processing_ms": 0.10524757496809986, "mean_env_wait_ms": 0.05007764640730317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004251241683959961, "StateBufferConnector_ms": 0.003549814224243164, "ViewRequirementAgentConnector_ms": 0.25447535514831543}}, "episode_reward_max": 500.0, "episode_reward_min": 59.0, "episode_reward_mean": 398.71, "episode_len_mean": 398.71, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [217.0, 336.0, 179.0, 90.0, 213.0, 153.0, 269.0, 169.0, 159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 425.0, 500.0, 496.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 424.0, 500.0, 238.0, 500.0, 500.0, 500.0], "episode_lengths": [217, 336, 179, 90, 213, 153, 269, 169, 159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 361, 500, 500, 425, 500, 496, 500, 500, 500, 500, 337, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 238, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4424604342425282, "mean_inference_ms": 1.2639063529966217, "mean_action_processing_ms": 0.10524757496809986, "mean_env_wait_ms": 0.05007764640730317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004251241683959961, "StateBufferConnector_ms": 0.003549814224243164, "ViewRequirementAgentConnector_ms": 0.25447535514831543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 265.61792554200196, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 56000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 15127.413, "sample_time_ms": 7417.024, "synch_weights_time_ms": 2.436}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 507, "training_iteration": 14, "trial_id": "1b194_00000", "date": "2023-08-15_12-47-09", "timestamp": 1692103629, "time_this_iter_s": 33.761213541030884, "time_total_s": 308.53956389427185, "pid": 7305, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc6cfada170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 308.53956389427185, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 28.839583333333334, "ram_util_percent": 23.522916666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.81688758813496}, "default_policy": {"total_loss": 9.81688758813496, "policy_loss": -0.0010613959343698837, "vf_loss": 9.817832188311415, "vf_loss_unclipped": 1583.1997783148468, "vf_explained_var": -0.007950228668733446, "entropy": 0.5434160883556297, "mean_kl_loss": 0.006229729996226454, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.01875000074505806}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 59.0, "episode_reward_mean": 422.45, "episode_len_mean": 422.45, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 425.0, 500.0, 496.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 424.0, 500.0, 238.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 361, 500, 500, 425, 500, 496, 500, 500, 500, 500, 337, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 238, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4411923579771589, "mean_inference_ms": 1.2635027712664566, "mean_action_processing_ms": 0.10524727422627507, "mean_env_wait_ms": 0.050061793700837444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042307376861572266, "StateBufferConnector_ms": 0.003555774688720703, "ViewRequirementAgentConnector_ms": 0.2549917697906494}}, "episode_reward_max": 500.0, "episode_reward_min": 59.0, "episode_reward_mean": 422.45, "episode_len_mean": 422.45, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [159.0, 332.0, 291.0, 169.0, 152.0, 144.0, 269.0, 337.0, 120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 425.0, 500.0, 496.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 424.0, 500.0, 238.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [159, 332, 291, 169, 152, 144, 269, 337, 120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 361, 500, 500, 425, 500, 496, 500, 500, 500, 500, 337, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 238, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4411923579771589, "mean_inference_ms": 1.2635027712664566, "mean_action_processing_ms": 0.10524727422627507, "mean_env_wait_ms": 0.050061793700837444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042307376861572266, "StateBufferConnector_ms": 0.003555774688720703, "ViewRequirementAgentConnector_ms": 0.2549917697906494}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.3958887023785, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 60000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 15125.139, "sample_time_ms": 7412.043, "synch_weights_time_ms": 2.441}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 515, "training_iteration": 15, "trial_id": "1b194_00000", "date": "2023-08-15_12-47-24", "timestamp": 1692103644, "time_this_iter_s": 15.131363153457642, "time_total_s": 323.6709270477295, "pid": 7305, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc6cfada170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 323.6709270477295, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 28.968181818181822, "ram_util_percent": 23.572727272727278}}
{"evaluation": {"sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 500.0, "episode_reward_mean": 500.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43018532822810973, "mean_inference_ms": 1.2628446099328494, "mean_action_processing_ms": 0.10247331719695034, "mean_env_wait_ms": 0.050115914638849034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004029273986816406, "StateBufferConnector_ms": 0.0034415721893310547, "ViewRequirementAgentConnector_ms": 0.2573883533477783}}, "episode_reward_max": 500.0, "episode_reward_min": 500.0, "episode_reward_mean": 500.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43018532822810973, "mean_inference_ms": 1.2628446099328494, "mean_action_processing_ms": 0.10247331719695034, "mean_env_wait_ms": 0.050115914638849034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004029273986816406, "StateBufferConnector_ms": 0.0034415721893310547, "ViewRequirementAgentConnector_ms": 0.2573883533477783}, "num_agent_steps_sampled_this_iter": 10000, "num_env_steps_sampled_this_iter": 10000, "timesteps_this_iter": 10000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.801984242030553}, "default_policy": {"total_loss": 9.801984242030553, "policy_loss": -0.001085424206968246, "vf_loss": 9.802891547237632, "vf_loss_unclipped": 1361.7857679354865, "vf_explained_var": -0.005817662106394005, "entropy": 0.5377882545563712, "mean_kl_loss": 0.009501657560792113, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.01875000074505806}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 59.0, "episode_reward_mean": 443.92, "episode_len_mean": 443.92, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 425.0, 500.0, 496.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 424.0, 500.0, 238.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 361, 500, 500, 425, 500, 496, 500, 500, 500, 500, 337, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 238, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43991211883432185, "mean_inference_ms": 1.2630966869469609, "mean_action_processing_ms": 0.10524941412638908, "mean_env_wait_ms": 0.05004646164476918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00420379638671875, "StateBufferConnector_ms": 0.0035648345947265625, "ViewRequirementAgentConnector_ms": 0.2570834159851074}}, "episode_reward_max": 500.0, "episode_reward_min": 59.0, "episode_reward_mean": 443.92, "episode_len_mean": 443.92, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [120.0, 162.0, 91.0, 69.0, 59.0, 245.0, 162.0, 481.0, 500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 425.0, 500.0, 496.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 424.0, 500.0, 238.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [120, 162, 91, 69, 59, 245, 162, 481, 500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 361, 500, 500, 425, 500, 496, 500, 500, 500, 500, 337, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 238, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43991211883432185, "mean_inference_ms": 1.2630966869469609, "mean_action_processing_ms": 0.10524941412638908, "mean_env_wait_ms": 0.05004646164476918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00420379638671875, "StateBufferConnector_ms": 0.0035648345947265625, "ViewRequirementAgentConnector_ms": 0.2570834159851074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.99061196327574, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 64000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 15123.617, "sample_time_ms": 7414.783, "synch_weights_time_ms": 2.436}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 523, "training_iteration": 16, "trial_id": "1b194_00000", "date": "2023-08-15_12-47-58", "timestamp": 1692103678, "time_this_iter_s": 33.66045117378235, "time_total_s": 357.33137822151184, "pid": 7305, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc6cfada170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 357.33137822151184, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 29.266666666666666, "ram_util_percent": 23.54166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.784833149615126}, "default_policy": {"total_loss": 9.784833149615126, "policy_loss": -0.0017970570719052256, "vf_loss": 9.786535294579545, "vf_loss_unclipped": 1162.1824670071794, "vf_explained_var": 0.0018367977030495845, "entropy": 0.5152483229189794, "mean_kl_loss": 0.00506168320673827, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.01875000074505806}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 85.0, "episode_reward_mean": 470.03, "episode_len_mean": 470.03, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 425.0, 500.0, 496.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 424.0, 500.0, 238.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 361, 500, 500, 425, 500, 496, 500, 500, 500, 500, 337, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 238, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43870387227452057, "mean_inference_ms": 1.2626863078212454, "mean_action_processing_ms": 0.1052528181411262, "mean_env_wait_ms": 0.050031929042612146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004192829132080078, "StateBufferConnector_ms": 0.003559112548828125, "ViewRequirementAgentConnector_ms": 0.2561838626861572}}, "episode_reward_max": 500.0, "episode_reward_min": 85.0, "episode_reward_mean": 470.03, "episode_len_mean": 470.03, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 166.0, 405.0, 220.0, 500.0, 440.0, 500.0, 470.0, 389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 425.0, 500.0, 496.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 424.0, 500.0, 238.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 166, 405, 220, 500, 440, 500, 470, 389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 361, 500, 500, 425, 500, 496, 500, 500, 500, 500, 337, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 238, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43870387227452057, "mean_inference_ms": 1.2626863078212454, "mean_action_processing_ms": 0.1052528181411262, "mean_env_wait_ms": 0.050031929042612146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004192829132080078, "StateBufferConnector_ms": 0.003559112548828125, "ViewRequirementAgentConnector_ms": 0.2561838626861572}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.68960679987157, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 68000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 15119.511, "sample_time_ms": 7412.898, "synch_weights_time_ms": 2.439}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 531, "training_iteration": 17, "trial_id": "1b194_00000", "date": "2023-08-15_12-48-13", "timestamp": 1692103693, "time_this_iter_s": 15.114949226379395, "time_total_s": 372.44632744789124, "pid": 7305, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc6cfada170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 372.44632744789124, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 29.357142857142858, "ram_util_percent": 23.623809523809527}}
{"evaluation": {"sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 331.0, "episode_reward_mean": 442.8, "episode_len_mean": 442.8, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.0, 500.0, 358.0, 416.0, 500.0, 500.0, 500.0, 500.0, 397.0, 500.0, 418.0, 500.0, 500.0, 500.0, 375.0, 500.0, 343.0, 500.0, 331.0, 364.0], "episode_lengths": [354, 500, 358, 416, 500, 500, 500, 500, 397, 500, 418, 500, 500, 500, 375, 500, 343, 500, 331, 364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4302273095414562, "mean_inference_ms": 1.2637093887134416, "mean_action_processing_ms": 0.10260808288729965, "mean_env_wait_ms": 0.05013949816308753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004150867462158203, "StateBufferConnector_ms": 0.0034105777740478516, "ViewRequirementAgentConnector_ms": 0.26085495948791504}}, "episode_reward_max": 500.0, "episode_reward_min": 331.0, "episode_reward_mean": 442.8, "episode_len_mean": 442.8, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.0, 500.0, 358.0, 416.0, 500.0, 500.0, 500.0, 500.0, 397.0, 500.0, 418.0, 500.0, 500.0, 500.0, 375.0, 500.0, 343.0, 500.0, 331.0, 364.0], "episode_lengths": [354, 500, 358, 416, 500, 500, 500, 500, 397, 500, 418, 500, 500, 500, 375, 500, 343, 500, 331, 364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4302273095414562, "mean_inference_ms": 1.2637093887134416, "mean_action_processing_ms": 0.10260808288729965, "mean_env_wait_ms": 0.05013949816308753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004150867462158203, "StateBufferConnector_ms": 0.0034105777740478516, "ViewRequirementAgentConnector_ms": 0.26085495948791504}, "num_agent_steps_sampled_this_iter": 8856, "num_env_steps_sampled_this_iter": 8856, "timesteps_this_iter": 8856, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.763232317560517}, "default_policy": {"total_loss": 9.763232317560517, "policy_loss": -0.003815779761810388, "vf_loss": 9.76692422976626, "vf_loss_unclipped": 975.6227210396643, "vf_explained_var": -0.0003951202704708205, "entropy": 0.5079222602376552, "mean_kl_loss": 0.006605164343827586, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.01875000074505806}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 85.0, "episode_reward_mean": 478.02, "episode_len_mean": 478.02, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 425.0, 500.0, 496.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 424.0, 500.0, 238.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 361, 500, 500, 425, 500, 496, 500, 500, 500, 500, 337, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 238, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4376729258062394, "mean_inference_ms": 1.2623048080652797, "mean_action_processing_ms": 0.10525425676267712, "mean_env_wait_ms": 0.05001914172735107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004086494445800781, "StateBufferConnector_ms": 0.0035486221313476562, "ViewRequirementAgentConnector_ms": 0.25545310974121094}}, "episode_reward_max": 500.0, "episode_reward_min": 85.0, "episode_reward_mean": 478.02, "episode_len_mean": 478.02, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [389.0, 500.0, 461.0, 318.0, 188.0, 500.0, 408.0, 500.0, 500.0, 85.0, 500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 252.0, 500.0, 500.0, 500.0, 500.0, 500.0, 361.0, 500.0, 500.0, 425.0, 500.0, 496.0, 500.0, 500.0, 500.0, 500.0, 337.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 424.0, 500.0, 238.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [389, 500, 461, 318, 188, 500, 408, 500, 500, 85, 500, 500, 500, 420, 500, 500, 500, 500, 500, 500, 500, 500, 500, 252, 500, 500, 500, 500, 500, 361, 500, 500, 425, 500, 496, 500, 500, 500, 500, 337, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 424, 500, 238, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4376729258062394, "mean_inference_ms": 1.2623048080652797, "mean_action_processing_ms": 0.10525425676267712, "mean_env_wait_ms": 0.05001914172735107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004086494445800781, "StateBufferConnector_ms": 0.0035486221313476562, "ViewRequirementAgentConnector_ms": 0.25545310974121094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 263.60676216094237, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 72000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 15121.634, "sample_time_ms": 7407.838, "synch_weights_time_ms": 2.473}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 539, "training_iteration": 18, "trial_id": "1b194_00000", "date": "2023-08-15_12-48-45", "timestamp": 1692103725, "time_this_iter_s": 31.7041597366333, "time_total_s": 404.15048718452454, "pid": 7305, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc6cfada170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 404.15048718452454, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 29.437777777777768, "ram_util_percent": 23.577777777777783}}
