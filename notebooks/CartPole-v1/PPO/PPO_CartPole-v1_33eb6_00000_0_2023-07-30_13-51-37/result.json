{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 7.135726764003859}, "default_policy": {"total_loss": 7.135726764003859, "policy_loss": -0.04112923870444981, "vf_loss": 7.17190902446633, "vf_loss_unclipped": 99.80738219981001, "vf_explained_var": 0.1700839622696834, "entropy": 0.6771386308329446, "mean_kl_loss": 0.02473499187946695, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 55.0, "episode_reward_min": 8.0, "episode_reward_mean": 20.87958115183246, "episode_len_mean": 20.87958115183246, "episode_media": {}, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, 9.0, 10.0, 16.0, 11.0, 24.0, 20.0, 10.0, 27.0, 23.0, 15.0, 27.0, 22.0, 9.0, 11.0, 20.0, 17.0, 22.0, 13.0, 18.0, 20.0, 12.0, 11.0, 19.0, 13.0, 43.0, 19.0, 11.0, 15.0, 35.0, 15.0, 27.0, 14.0, 11.0, 15.0, 27.0, 13.0, 14.0, 21.0, 22.0, 25.0, 37.0, 35.0, 23.0, 17.0, 12.0, 12.0, 15.0, 17.0, 15.0, 26.0, 16.0, 26.0, 17.0, 20.0, 25.0, 16.0, 35.0, 27.0, 14.0, 16.0, 51.0, 10.0, 32.0, 25.0, 10.0, 28.0, 31.0, 13.0, 28.0, 13.0, 12.0, 29.0, 55.0, 16.0, 15.0, 11.0, 10.0, 37.0, 18.0, 17.0, 31.0, 42.0, 19.0, 16.0, 22.0, 12.0, 37.0, 15.0, 18.0, 21.0, 28.0, 31.0, 14.0, 23.0, 14.0, 34.0, 14.0, 12.0, 18.0, 20.0, 44.0, 13.0, 14.0, 24.0, 40.0, 12.0, 31.0, 15.0, 24.0, 12.0, 31.0, 24.0, 20.0, 15.0, 13.0, 39.0, 38.0, 19.0, 20.0, 50.0, 15.0, 19.0, 9.0, 11.0, 18.0, 20.0, 30.0, 21.0, 22.0, 14.0, 27.0, 20.0, 38.0, 29.0, 10.0, 16.0, 25.0, 14.0, 30.0, 9.0, 18.0, 20.0, 12.0, 16.0, 28.0, 35.0, 26.0, 18.0, 10.0, 10.0, 20.0, 18.0, 28.0, 21.0, 22.0, 8.0, 30.0, 37.0, 13.0, 10.0, 16.0, 21.0, 12.0, 24.0, 29.0, 43.0, 21.0, 36.0, 25.0, 11.0, 21.0, 20.0, 13.0, 22.0, 21.0, 15.0, 13.0, 20.0, 16.0, 22.0, 11.0, 11.0, 35.0, 43.0, 16.0, 32.0, 20.0, 14.0, 15.0, 10.0], "episode_lengths": [16, 9, 10, 16, 11, 24, 20, 10, 27, 23, 15, 27, 22, 9, 11, 20, 17, 22, 13, 18, 20, 12, 11, 19, 13, 43, 19, 11, 15, 35, 15, 27, 14, 11, 15, 27, 13, 14, 21, 22, 25, 37, 35, 23, 17, 12, 12, 15, 17, 15, 26, 16, 26, 17, 20, 25, 16, 35, 27, 14, 16, 51, 10, 32, 25, 10, 28, 31, 13, 28, 13, 12, 29, 55, 16, 15, 11, 10, 37, 18, 17, 31, 42, 19, 16, 22, 12, 37, 15, 18, 21, 28, 31, 14, 23, 14, 34, 14, 12, 18, 20, 44, 13, 14, 24, 40, 12, 31, 15, 24, 12, 31, 24, 20, 15, 13, 39, 38, 19, 20, 50, 15, 19, 9, 11, 18, 20, 30, 21, 22, 14, 27, 20, 38, 29, 10, 16, 25, 14, 30, 9, 18, 20, 12, 16, 28, 35, 26, 18, 10, 10, 20, 18, 28, 21, 22, 8, 30, 37, 13, 10, 16, 21, 12, 24, 29, 43, 21, 36, 25, 11, 21, 20, 13, 22, 21, 15, 13, 20, 16, 22, 11, 11, 35, 43, 16, 32, 20, 14, 15, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5512590916029845, "mean_inference_ms": 1.661945539425385, "mean_action_processing_ms": 0.12481424159569852, "mean_env_wait_ms": 0.06450357749384064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005750506336152241, "StateBufferConnector_ms": 0.004397387279889971, "ViewRequirementAgentConnector_ms": 0.2884233185134009}}, "episode_reward_max": 55.0, "episode_reward_min": 8.0, "episode_reward_mean": 20.87958115183246, "episode_len_mean": 20.87958115183246, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.0, 9.0, 10.0, 16.0, 11.0, 24.0, 20.0, 10.0, 27.0, 23.0, 15.0, 27.0, 22.0, 9.0, 11.0, 20.0, 17.0, 22.0, 13.0, 18.0, 20.0, 12.0, 11.0, 19.0, 13.0, 43.0, 19.0, 11.0, 15.0, 35.0, 15.0, 27.0, 14.0, 11.0, 15.0, 27.0, 13.0, 14.0, 21.0, 22.0, 25.0, 37.0, 35.0, 23.0, 17.0, 12.0, 12.0, 15.0, 17.0, 15.0, 26.0, 16.0, 26.0, 17.0, 20.0, 25.0, 16.0, 35.0, 27.0, 14.0, 16.0, 51.0, 10.0, 32.0, 25.0, 10.0, 28.0, 31.0, 13.0, 28.0, 13.0, 12.0, 29.0, 55.0, 16.0, 15.0, 11.0, 10.0, 37.0, 18.0, 17.0, 31.0, 42.0, 19.0, 16.0, 22.0, 12.0, 37.0, 15.0, 18.0, 21.0, 28.0, 31.0, 14.0, 23.0, 14.0, 34.0, 14.0, 12.0, 18.0, 20.0, 44.0, 13.0, 14.0, 24.0, 40.0, 12.0, 31.0, 15.0, 24.0, 12.0, 31.0, 24.0, 20.0, 15.0, 13.0, 39.0, 38.0, 19.0, 20.0, 50.0, 15.0, 19.0, 9.0, 11.0, 18.0, 20.0, 30.0, 21.0, 22.0, 14.0, 27.0, 20.0, 38.0, 29.0, 10.0, 16.0, 25.0, 14.0, 30.0, 9.0, 18.0, 20.0, 12.0, 16.0, 28.0, 35.0, 26.0, 18.0, 10.0, 10.0, 20.0, 18.0, 28.0, 21.0, 22.0, 8.0, 30.0, 37.0, 13.0, 10.0, 16.0, 21.0, 12.0, 24.0, 29.0, 43.0, 21.0, 36.0, 25.0, 11.0, 21.0, 20.0, 13.0, 22.0, 21.0, 15.0, 13.0, 20.0, 16.0, 22.0, 11.0, 11.0, 35.0, 43.0, 16.0, 32.0, 20.0, 14.0, 15.0, 10.0], "episode_lengths": [16, 9, 10, 16, 11, 24, 20, 10, 27, 23, 15, 27, 22, 9, 11, 20, 17, 22, 13, 18, 20, 12, 11, 19, 13, 43, 19, 11, 15, 35, 15, 27, 14, 11, 15, 27, 13, 14, 21, 22, 25, 37, 35, 23, 17, 12, 12, 15, 17, 15, 26, 16, 26, 17, 20, 25, 16, 35, 27, 14, 16, 51, 10, 32, 25, 10, 28, 31, 13, 28, 13, 12, 29, 55, 16, 15, 11, 10, 37, 18, 17, 31, 42, 19, 16, 22, 12, 37, 15, 18, 21, 28, 31, 14, 23, 14, 34, 14, 12, 18, 20, 44, 13, 14, 24, 40, 12, 31, 15, 24, 12, 31, 24, 20, 15, 13, 39, 38, 19, 20, 50, 15, 19, 9, 11, 18, 20, 30, 21, 22, 14, 27, 20, 38, 29, 10, 16, 25, 14, 30, 9, 18, 20, 12, 16, 28, 35, 26, 18, 10, 10, 20, 18, 28, 21, 22, 8, 30, 37, 13, 10, 16, 21, 12, 24, 29, 43, 21, 36, 25, 11, 21, 20, 13, 22, 21, 15, 13, 20, 16, 22, 11, 11, 35, 43, 16, 32, 20, 14, 15, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5512590916029845, "mean_inference_ms": 1.661945539425385, "mean_action_processing_ms": 0.12481424159569852, "mean_env_wait_ms": 0.06450357749384064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005750506336152241, "StateBufferConnector_ms": 0.004397387279889971, "ViewRequirementAgentConnector_ms": 0.2884233185134009}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 253.33351553824073, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 15789.419, "sample_time_ms": 9678.261, "synch_weights_time_ms": 2.948}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 191, "training_iteration": 1, "trial_id": "33eb6_00000", "date": "2023-07-30_13-52-09", "timestamp": 1690725129, "time_this_iter_s": 15.797888040542603, "time_total_s": 15.797888040542603, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 15.797888040542603, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 31.69565217391305, "ram_util_percent": 83.56956521739129}}
{"evaluation": {"sampler_results": {"episode_reward_max": 196.0, "episode_reward_min": 24.0, "episode_reward_mean": 87.65, "episode_len_mean": 87.65, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [109.0, 57.0, 46.0, 128.0, 65.0, 78.0, 31.0, 107.0, 32.0, 196.0, 39.0, 151.0, 130.0, 132.0, 47.0, 48.0, 83.0, 165.0, 85.0, 24.0], "episode_lengths": [109, 57, 46, 128, 65, 78, 31, 107, 32, 196, 39, 151, 130, 132, 47, 48, 83, 165, 85, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5068929872327954, "mean_inference_ms": 1.6318562365176335, "mean_action_processing_ms": 0.1252576997641691, "mean_env_wait_ms": 0.06470753638203358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060999393463134766, "StateBufferConnector_ms": 0.004193782806396484, "ViewRequirementAgentConnector_ms": 0.2968728542327881}}, "episode_reward_max": 196.0, "episode_reward_min": 24.0, "episode_reward_mean": 87.65, "episode_len_mean": 87.65, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [109.0, 57.0, 46.0, 128.0, 65.0, 78.0, 31.0, 107.0, 32.0, 196.0, 39.0, 151.0, 130.0, 132.0, 47.0, 48.0, 83.0, 165.0, 85.0, 24.0], "episode_lengths": [109, 57, 46, 128, 65, 78, 31, 107, 32, 196, 39, 151, 130, 132, 47, 48, 83, 165, 85, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5068929872327954, "mean_inference_ms": 1.6318562365176335, "mean_action_processing_ms": 0.1252576997641691, "mean_env_wait_ms": 0.06470753638203358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060999393463134766, "StateBufferConnector_ms": 0.004193782806396484, "ViewRequirementAgentConnector_ms": 0.2968728542327881}, "num_agent_steps_sampled_this_iter": 1753, "num_env_steps_sampled_this_iter": 1753, "timesteps_this_iter": 1753, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 7.975797537801617}, "default_policy": {"total_loss": 7.975797537801617, "policy_loss": -0.029100734405150052, "vf_loss": 7.999918702823012, "vf_loss_unclipped": 236.67134158494375, "vf_explained_var": 0.17438377392317442, "entropy": 0.6256906159523962, "mean_kl_loss": 0.016598578190421823, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 108.0, "episode_reward_min": 10.0, "episode_reward_mean": 34.258620689655174, "episode_len_mean": 34.258620689655174, "episode_media": {}, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0, 23.0, 71.0, 18.0, 26.0, 42.0, 54.0, 58.0, 30.0, 23.0, 61.0, 12.0, 34.0, 51.0, 27.0, 25.0, 18.0, 22.0, 30.0, 14.0, 33.0, 21.0, 42.0, 50.0, 53.0, 40.0, 33.0, 15.0, 53.0, 50.0, 17.0, 14.0, 28.0, 35.0, 13.0, 13.0, 29.0, 22.0, 29.0, 68.0, 57.0, 58.0, 20.0, 33.0, 13.0, 18.0, 17.0, 41.0, 24.0, 18.0, 27.0, 22.0, 31.0, 44.0, 27.0, 57.0, 37.0, 108.0, 70.0, 91.0, 17.0, 22.0, 22.0, 16.0, 23.0, 49.0, 29.0, 51.0, 22.0, 33.0, 35.0, 52.0, 13.0, 71.0, 50.0, 32.0, 25.0, 24.0, 40.0, 37.0, 71.0, 13.0, 26.0, 24.0, 22.0, 61.0, 21.0, 18.0, 10.0, 18.0, 13.0, 34.0, 33.0, 24.0, 29.0, 36.0, 18.0, 45.0, 36.0, 30.0, 65.0, 24.0, 45.0, 22.0, 37.0, 16.0, 30.0, 45.0, 63.0, 41.0, 39.0, 24.0, 22.0, 82.0, 24.0, 22.0], "episode_lengths": [18, 23, 71, 18, 26, 42, 54, 58, 30, 23, 61, 12, 34, 51, 27, 25, 18, 22, 30, 14, 33, 21, 42, 50, 53, 40, 33, 15, 53, 50, 17, 14, 28, 35, 13, 13, 29, 22, 29, 68, 57, 58, 20, 33, 13, 18, 17, 41, 24, 18, 27, 22, 31, 44, 27, 57, 37, 108, 70, 91, 17, 22, 22, 16, 23, 49, 29, 51, 22, 33, 35, 52, 13, 71, 50, 32, 25, 24, 40, 37, 71, 13, 26, 24, 22, 61, 21, 18, 10, 18, 13, 34, 33, 24, 29, 36, 18, 45, 36, 30, 65, 24, 45, 22, 37, 16, 30, 45, 63, 41, 39, 24, 22, 82, 24, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5388404410893494, "mean_inference_ms": 1.6626862939663671, "mean_action_processing_ms": 0.12428557004143095, "mean_env_wait_ms": 0.06413185630734453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005533366367734712, "StateBufferConnector_ms": 0.004208704520916116, "ViewRequirementAgentConnector_ms": 0.2905280425630767}}, "episode_reward_max": 108.0, "episode_reward_min": 10.0, "episode_reward_mean": 34.258620689655174, "episode_len_mean": 34.258620689655174, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.0, 23.0, 71.0, 18.0, 26.0, 42.0, 54.0, 58.0, 30.0, 23.0, 61.0, 12.0, 34.0, 51.0, 27.0, 25.0, 18.0, 22.0, 30.0, 14.0, 33.0, 21.0, 42.0, 50.0, 53.0, 40.0, 33.0, 15.0, 53.0, 50.0, 17.0, 14.0, 28.0, 35.0, 13.0, 13.0, 29.0, 22.0, 29.0, 68.0, 57.0, 58.0, 20.0, 33.0, 13.0, 18.0, 17.0, 41.0, 24.0, 18.0, 27.0, 22.0, 31.0, 44.0, 27.0, 57.0, 37.0, 108.0, 70.0, 91.0, 17.0, 22.0, 22.0, 16.0, 23.0, 49.0, 29.0, 51.0, 22.0, 33.0, 35.0, 52.0, 13.0, 71.0, 50.0, 32.0, 25.0, 24.0, 40.0, 37.0, 71.0, 13.0, 26.0, 24.0, 22.0, 61.0, 21.0, 18.0, 10.0, 18.0, 13.0, 34.0, 33.0, 24.0, 29.0, 36.0, 18.0, 45.0, 36.0, 30.0, 65.0, 24.0, 45.0, 22.0, 37.0, 16.0, 30.0, 45.0, 63.0, 41.0, 39.0, 24.0, 22.0, 82.0, 24.0, 22.0], "episode_lengths": [18, 23, 71, 18, 26, 42, 54, 58, 30, 23, 61, 12, 34, 51, 27, 25, 18, 22, 30, 14, 33, 21, 42, 50, 53, 40, 33, 15, 53, 50, 17, 14, 28, 35, 13, 13, 29, 22, 29, 68, 57, 58, 20, 33, 13, 18, 17, 41, 24, 18, 27, 22, 31, 44, 27, 57, 37, 108, 70, 91, 17, 22, 22, 16, 23, 49, 29, 51, 22, 33, 35, 52, 13, 71, 50, 32, 25, 24, 40, 37, 71, 13, 26, 24, 22, 61, 21, 18, 10, 18, 13, 34, 33, 24, 29, 36, 18, 45, 36, 30, 65, 24, 45, 22, 37, 16, 30, 45, 63, 41, 39, 24, 22, 82, 24, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5388404410893494, "mean_inference_ms": 1.6626862939663671, "mean_action_processing_ms": 0.12428557004143095, "mean_env_wait_ms": 0.06413185630734453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005533366367734712, "StateBufferConnector_ms": 0.004208704520916116, "ViewRequirementAgentConnector_ms": 0.2905280425630767}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 261.02168424854375, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 15556.883, "sample_time_ms": 9625.862, "synch_weights_time_ms": 3.189}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 307, "training_iteration": 2, "trial_id": "33eb6_00000", "date": "2023-07-30_13-52-29", "timestamp": 1690725149, "time_this_iter_s": 19.455113172531128, "time_total_s": 35.25300121307373, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 35.25300121307373, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 32.925, "ram_util_percent": 83.70357142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.039382065282956}, "default_policy": {"total_loss": 9.039382065282956, "policy_loss": -0.019338351301054584, "vf_loss": 9.055571649120306, "vf_loss_unclipped": 860.6949978240772, "vf_explained_var": 0.09994715871587237, "entropy": 0.5880964753597275, "mean_kl_loss": 0.010495920893053151, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 177.0, "episode_reward_min": 10.0, "episode_reward_mean": 54.53, "episode_len_mean": 54.53, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.0, 71.0, 50.0, 32.0, 25.0, 24.0, 40.0, 37.0, 71.0, 13.0, 26.0, 24.0, 22.0, 61.0, 21.0, 18.0, 10.0, 18.0, 13.0, 34.0, 33.0, 24.0, 29.0, 36.0, 18.0, 45.0, 36.0, 30.0, 65.0, 24.0, 45.0, 22.0, 37.0, 16.0, 30.0, 45.0, 63.0, 41.0, 39.0, 24.0, 22.0, 82.0, 24.0, 22.0, 88.0, 107.0, 52.0, 15.0, 59.0, 99.0, 77.0, 53.0, 85.0, 68.0, 29.0, 56.0, 49.0, 31.0, 54.0, 177.0, 69.0, 51.0, 69.0, 70.0, 20.0, 49.0, 82.0, 135.0, 119.0, 98.0, 94.0, 87.0, 81.0, 73.0, 59.0, 17.0, 137.0, 39.0, 134.0, 152.0, 75.0, 19.0, 139.0, 14.0, 37.0, 73.0, 133.0, 77.0, 55.0, 25.0, 75.0, 22.0, 22.0, 56.0, 35.0, 106.0, 76.0, 42.0, 69.0, 94.0], "episode_lengths": [13, 71, 50, 32, 25, 24, 40, 37, 71, 13, 26, 24, 22, 61, 21, 18, 10, 18, 13, 34, 33, 24, 29, 36, 18, 45, 36, 30, 65, 24, 45, 22, 37, 16, 30, 45, 63, 41, 39, 24, 22, 82, 24, 22, 88, 107, 52, 15, 59, 99, 77, 53, 85, 68, 29, 56, 49, 31, 54, 177, 69, 51, 69, 70, 20, 49, 82, 135, 119, 98, 94, 87, 81, 73, 59, 17, 137, 39, 134, 152, 75, 19, 139, 14, 37, 73, 133, 77, 55, 25, 75, 22, 22, 56, 35, 106, 76, 42, 69, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5312377801322543, "mean_inference_ms": 1.656995704525677, "mean_action_processing_ms": 0.12401113342215733, "mean_env_wait_ms": 0.06377274354808192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005313873291015625, "StateBufferConnector_ms": 0.004111051559448242, "ViewRequirementAgentConnector_ms": 0.28421926498413086}}, "episode_reward_max": 177.0, "episode_reward_min": 10.0, "episode_reward_mean": 54.53, "episode_len_mean": 54.53, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.0, 71.0, 50.0, 32.0, 25.0, 24.0, 40.0, 37.0, 71.0, 13.0, 26.0, 24.0, 22.0, 61.0, 21.0, 18.0, 10.0, 18.0, 13.0, 34.0, 33.0, 24.0, 29.0, 36.0, 18.0, 45.0, 36.0, 30.0, 65.0, 24.0, 45.0, 22.0, 37.0, 16.0, 30.0, 45.0, 63.0, 41.0, 39.0, 24.0, 22.0, 82.0, 24.0, 22.0, 88.0, 107.0, 52.0, 15.0, 59.0, 99.0, 77.0, 53.0, 85.0, 68.0, 29.0, 56.0, 49.0, 31.0, 54.0, 177.0, 69.0, 51.0, 69.0, 70.0, 20.0, 49.0, 82.0, 135.0, 119.0, 98.0, 94.0, 87.0, 81.0, 73.0, 59.0, 17.0, 137.0, 39.0, 134.0, 152.0, 75.0, 19.0, 139.0, 14.0, 37.0, 73.0, 133.0, 77.0, 55.0, 25.0, 75.0, 22.0, 22.0, 56.0, 35.0, 106.0, 76.0, 42.0, 69.0, 94.0], "episode_lengths": [13, 71, 50, 32, 25, 24, 40, 37, 71, 13, 26, 24, 22, 61, 21, 18, 10, 18, 13, 34, 33, 24, 29, 36, 18, 45, 36, 30, 65, 24, 45, 22, 37, 16, 30, 45, 63, 41, 39, 24, 22, 82, 24, 22, 88, 107, 52, 15, 59, 99, 77, 53, 85, 68, 29, 56, 49, 31, 54, 177, 69, 51, 69, 70, 20, 49, 82, 135, 119, 98, 94, 87, 81, 73, 59, 17, 137, 39, 134, 152, 75, 19, 139, 14, 37, 73, 133, 77, 55, 25, 75, 22, 22, 56, 35, 106, 76, 42, 69, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5312377801322543, "mean_inference_ms": 1.656995704525677, "mean_action_processing_ms": 0.12401113342215733, "mean_env_wait_ms": 0.06377274354808192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005313873291015625, "StateBufferConnector_ms": 0.004111051559448242, "ViewRequirementAgentConnector_ms": 0.28421926498413086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 266.7521093449198, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 15369.641, "sample_time_ms": 9524.327, "synch_weights_time_ms": 3.137}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 363, "training_iteration": 3, "trial_id": "33eb6_00000", "date": "2023-07-30_13-52-44", "timestamp": 1690725164, "time_this_iter_s": 15.000568151473999, "time_total_s": 50.25356936454773, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 50.25356936454773, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 32.58095238095238, "ram_util_percent": 83.72857142857143}}
{"evaluation": {"sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 45.0, "episode_reward_mean": 244.0, "episode_len_mean": 244.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [288.0, 290.0, 412.0, 128.0, 352.0, 164.0, 262.0, 170.0, 153.0, 134.0, 288.0, 500.0, 140.0, 354.0, 324.0, 242.0, 221.0, 283.0, 45.0, 130.0], "episode_lengths": [288, 290, 412, 128, 352, 164, 262, 170, 153, 134, 288, 500, 140, 354, 324, 242, 221, 283, 45, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4959791081117727, "mean_inference_ms": 1.62105507113181, "mean_action_processing_ms": 0.12186463424733222, "mean_env_wait_ms": 0.06255095070444175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005506277084350586, "StateBufferConnector_ms": 0.003972053527832031, "ViewRequirementAgentConnector_ms": 0.291820764541626}}, "episode_reward_max": 500.0, "episode_reward_min": 45.0, "episode_reward_mean": 244.0, "episode_len_mean": 244.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [288.0, 290.0, 412.0, 128.0, 352.0, 164.0, 262.0, 170.0, 153.0, 134.0, 288.0, 500.0, 140.0, 354.0, 324.0, 242.0, 221.0, 283.0, 45.0, 130.0], "episode_lengths": [288, 290, 412, 128, 352, 164, 262, 170, 153, 134, 288, 500, 140, 354, 324, 242, 221, 283, 45, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4959791081117727, "mean_inference_ms": 1.62105507113181, "mean_action_processing_ms": 0.12186463424733222, "mean_env_wait_ms": 0.06255095070444175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005506277084350586, "StateBufferConnector_ms": 0.003972053527832031, "ViewRequirementAgentConnector_ms": 0.291820764541626}, "num_agent_steps_sampled_this_iter": 4880, "num_env_steps_sampled_this_iter": 4880, "timesteps_this_iter": 4880, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.411020127440821}, "default_policy": {"total_loss": 9.411020127440821, "policy_loss": -0.01171179663743387, "vf_loss": 9.420508485358916, "vf_loss_unclipped": 1764.6662919424743, "vf_explained_var": 0.09181384631057284, "entropy": 0.5627740789959426, "mean_kl_loss": 0.007411372391794888, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 266.0, "episode_reward_min": 14.0, "episode_reward_mean": 83.54, "episode_len_mean": 83.54, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, 30.0, 45.0, 63.0, 41.0, 39.0, 24.0, 22.0, 82.0, 24.0, 22.0, 88.0, 107.0, 52.0, 15.0, 59.0, 99.0, 77.0, 53.0, 85.0, 68.0, 29.0, 56.0, 49.0, 31.0, 54.0, 177.0, 69.0, 51.0, 69.0, 70.0, 20.0, 49.0, 82.0, 135.0, 119.0, 98.0, 94.0, 87.0, 81.0, 73.0, 59.0, 17.0, 137.0, 39.0, 134.0, 152.0, 75.0, 19.0, 139.0, 14.0, 37.0, 73.0, 133.0, 77.0, 55.0, 25.0, 75.0, 22.0, 22.0, 56.0, 35.0, 106.0, 76.0, 42.0, 69.0, 94.0, 104.0, 125.0, 125.0, 114.0, 96.0, 266.0, 105.0, 51.0, 132.0, 147.0, 156.0, 251.0, 185.0, 180.0, 44.0, 112.0, 109.0, 119.0, 94.0, 87.0, 196.0, 29.0, 188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0], "episode_lengths": [16, 30, 45, 63, 41, 39, 24, 22, 82, 24, 22, 88, 107, 52, 15, 59, 99, 77, 53, 85, 68, 29, 56, 49, 31, 54, 177, 69, 51, 69, 70, 20, 49, 82, 135, 119, 98, 94, 87, 81, 73, 59, 17, 137, 39, 134, 152, 75, 19, 139, 14, 37, 73, 133, 77, 55, 25, 75, 22, 22, 56, 35, 106, 76, 42, 69, 94, 104, 125, 125, 114, 96, 266, 105, 51, 132, 147, 156, 251, 185, 180, 44, 112, 109, 119, 94, 87, 196, 29, 188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.525010431676412, "mean_inference_ms": 1.6551104426211811, "mean_action_processing_ms": 0.12393148806025459, "mean_env_wait_ms": 0.06358091361036382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005522966384887695, "StateBufferConnector_ms": 0.004210233688354492, "ViewRequirementAgentConnector_ms": 0.2914581298828125}}, "episode_reward_max": 266.0, "episode_reward_min": 14.0, "episode_reward_mean": 83.54, "episode_len_mean": 83.54, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.0, 30.0, 45.0, 63.0, 41.0, 39.0, 24.0, 22.0, 82.0, 24.0, 22.0, 88.0, 107.0, 52.0, 15.0, 59.0, 99.0, 77.0, 53.0, 85.0, 68.0, 29.0, 56.0, 49.0, 31.0, 54.0, 177.0, 69.0, 51.0, 69.0, 70.0, 20.0, 49.0, 82.0, 135.0, 119.0, 98.0, 94.0, 87.0, 81.0, 73.0, 59.0, 17.0, 137.0, 39.0, 134.0, 152.0, 75.0, 19.0, 139.0, 14.0, 37.0, 73.0, 133.0, 77.0, 55.0, 25.0, 75.0, 22.0, 22.0, 56.0, 35.0, 106.0, 76.0, 42.0, 69.0, 94.0, 104.0, 125.0, 125.0, 114.0, 96.0, 266.0, 105.0, 51.0, 132.0, 147.0, 156.0, 251.0, 185.0, 180.0, 44.0, 112.0, 109.0, 119.0, 94.0, 87.0, 196.0, 29.0, 188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0], "episode_lengths": [16, 30, 45, 63, 41, 39, 24, 22, 82, 24, 22, 88, 107, 52, 15, 59, 99, 77, 53, 85, 68, 29, 56, 49, 31, 54, 177, 69, 51, 69, 70, 20, 49, 82, 135, 119, 98, 94, 87, 81, 73, 59, 17, 137, 39, 134, 152, 75, 19, 139, 14, 37, 73, 133, 77, 55, 25, 75, 22, 22, 56, 35, 106, 76, 42, 69, 94, 104, 125, 125, 114, 96, 266, 105, 51, 132, 147, 156, 251, 185, 180, 44, 112, 109, 119, 94, 87, 196, 29, 188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.525010431676412, "mean_inference_ms": 1.6551104426211811, "mean_action_processing_ms": 0.12393148806025459, "mean_env_wait_ms": 0.06358091361036382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005522966384887695, "StateBufferConnector_ms": 0.004210233688354492, "ViewRequirementAgentConnector_ms": 0.2914581298828125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 265.0592709578342, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 15299.96, "sample_time_ms": 9521.36, "synch_weights_time_ms": 3.174}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 396, "training_iteration": 4, "trial_id": "33eb6_00000", "date": "2023-07-30_13-53-10", "timestamp": 1690725190, "time_this_iter_s": 26.355686902999878, "time_total_s": 76.60925626754761, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 76.60925626754761, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 33.12105263157895, "ram_util_percent": 83.3394736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.686971976558791}, "default_policy": {"total_loss": 9.686971976558791, "policy_loss": -0.009514191350750704, "vf_loss": 9.69419303275883, "vf_loss_unclipped": 2721.485622706952, "vf_explained_var": 0.07103586832343388, "entropy": 0.5575483407356592, "mean_kl_loss": 0.007643748837660651, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 396.0, "episode_reward_min": 14.0, "episode_reward_mean": 112.57, "episode_len_mean": 112.57, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [68.0, 29.0, 56.0, 49.0, 31.0, 54.0, 177.0, 69.0, 51.0, 69.0, 70.0, 20.0, 49.0, 82.0, 135.0, 119.0, 98.0, 94.0, 87.0, 81.0, 73.0, 59.0, 17.0, 137.0, 39.0, 134.0, 152.0, 75.0, 19.0, 139.0, 14.0, 37.0, 73.0, 133.0, 77.0, 55.0, 25.0, 75.0, 22.0, 22.0, 56.0, 35.0, 106.0, 76.0, 42.0, 69.0, 94.0, 104.0, 125.0, 125.0, 114.0, 96.0, 266.0, 105.0, 51.0, 132.0, 147.0, 156.0, 251.0, 185.0, 180.0, 44.0, 112.0, 109.0, 119.0, 94.0, 87.0, 196.0, 29.0, 188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0], "episode_lengths": [68, 29, 56, 49, 31, 54, 177, 69, 51, 69, 70, 20, 49, 82, 135, 119, 98, 94, 87, 81, 73, 59, 17, 137, 39, 134, 152, 75, 19, 139, 14, 37, 73, 133, 77, 55, 25, 75, 22, 22, 56, 35, 106, 76, 42, 69, 94, 104, 125, 125, 114, 96, 266, 105, 51, 132, 147, 156, 251, 185, 180, 44, 112, 109, 119, 94, 87, 196, 29, 188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5215476151541293, "mean_inference_ms": 1.6554949967381425, "mean_action_processing_ms": 0.12398364121253126, "mean_env_wait_ms": 0.06352787630650863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005677938461303711, "StateBufferConnector_ms": 0.004231691360473633, "ViewRequirementAgentConnector_ms": 0.29453015327453613}}, "episode_reward_max": 396.0, "episode_reward_min": 14.0, "episode_reward_mean": 112.57, "episode_len_mean": 112.57, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [68.0, 29.0, 56.0, 49.0, 31.0, 54.0, 177.0, 69.0, 51.0, 69.0, 70.0, 20.0, 49.0, 82.0, 135.0, 119.0, 98.0, 94.0, 87.0, 81.0, 73.0, 59.0, 17.0, 137.0, 39.0, 134.0, 152.0, 75.0, 19.0, 139.0, 14.0, 37.0, 73.0, 133.0, 77.0, 55.0, 25.0, 75.0, 22.0, 22.0, 56.0, 35.0, 106.0, 76.0, 42.0, 69.0, 94.0, 104.0, 125.0, 125.0, 114.0, 96.0, 266.0, 105.0, 51.0, 132.0, 147.0, 156.0, 251.0, 185.0, 180.0, 44.0, 112.0, 109.0, 119.0, 94.0, 87.0, 196.0, 29.0, 188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0], "episode_lengths": [68, 29, 56, 49, 31, 54, 177, 69, 51, 69, 70, 20, 49, 82, 135, 119, 98, 94, 87, 81, 73, 59, 17, 137, 39, 134, 152, 75, 19, 139, 14, 37, 73, 133, 77, 55, 25, 75, 22, 22, 56, 35, 106, 76, 42, 69, 94, 104, 125, 125, 114, 96, 266, 105, 51, 132, 147, 156, 251, 185, 180, 44, 112, 109, 119, 94, 87, 196, 29, 188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5215476151541293, "mean_inference_ms": 1.6554949967381425, "mean_action_processing_ms": 0.12398364121253126, "mean_env_wait_ms": 0.06352787630650863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005677938461303711, "StateBufferConnector_ms": 0.004231691360473633, "ViewRequirementAgentConnector_ms": 0.29453015327453613}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 263.02564140109826, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 15281.487, "sample_time_ms": 9516.177, "synch_weights_time_ms": 3.257}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 416, "training_iteration": 5, "trial_id": "33eb6_00000", "date": "2023-07-30_13-53-25", "timestamp": 1690725205, "time_this_iter_s": 15.211623668670654, "time_total_s": 91.82087993621826, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 91.82087993621826, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 34.161904761904765, "ram_util_percent": 83.21428571428571}}
{"evaluation": {"sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 103.0, "episode_reward_mean": 436.45, "episode_len_mean": 436.45, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 332.0, 500.0, 500.0, 152.0, 500.0, 323.0, 103.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 333.0, 486.0], "episode_lengths": [500, 500, 500, 500, 332, 500, 500, 152, 500, 323, 103, 500, 500, 500, 500, 500, 500, 500, 333, 486]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4974291177650437, "mean_inference_ms": 1.6262393161312083, "mean_action_processing_ms": 0.121794399988261, "mean_env_wait_ms": 0.06228072766035412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005791187286376953, "StateBufferConnector_ms": 0.003923177719116211, "ViewRequirementAgentConnector_ms": 0.2990269660949707}}, "episode_reward_max": 500.0, "episode_reward_min": 103.0, "episode_reward_mean": 436.45, "episode_len_mean": 436.45, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 332.0, 500.0, 500.0, 152.0, 500.0, 323.0, 103.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 333.0, 486.0], "episode_lengths": [500, 500, 500, 500, 332, 500, 500, 152, 500, 323, 103, 500, 500, 500, 500, 500, 500, 500, 333, 486]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4974291177650437, "mean_inference_ms": 1.6262393161312083, "mean_action_processing_ms": 0.121794399988261, "mean_env_wait_ms": 0.06228072766035412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005791187286376953, "StateBufferConnector_ms": 0.003923177719116211, "ViewRequirementAgentConnector_ms": 0.2990269660949707}, "num_agent_steps_sampled_this_iter": 8729, "num_env_steps_sampled_this_iter": 8729, "timesteps_this_iter": 8729, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.856852643271244}, "default_policy": {"total_loss": 9.856852643271244, "policy_loss": -0.006890406482108334, "vf_loss": 9.861975058817915, "vf_loss_unclipped": 4303.762674360133, "vf_explained_var": -0.08604445081275663, "entropy": 0.5576682119354256, "mean_kl_loss": 0.005893372686160213, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30000001192092896}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 14.0, "episode_reward_mean": 146.53, "episode_len_mean": 146.53, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.0, 20.0, 49.0, 82.0, 135.0, 119.0, 98.0, 94.0, 87.0, 81.0, 73.0, 59.0, 17.0, 137.0, 39.0, 134.0, 152.0, 75.0, 19.0, 139.0, 14.0, 37.0, 73.0, 133.0, 77.0, 55.0, 25.0, 75.0, 22.0, 22.0, 56.0, 35.0, 106.0, 76.0, 42.0, 69.0, 94.0, 104.0, 125.0, 125.0, 114.0, 96.0, 266.0, 105.0, 51.0, 132.0, 147.0, 156.0, 251.0, 185.0, 180.0, 44.0, 112.0, 109.0, 119.0, 94.0, 87.0, 196.0, 29.0, 188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0], "episode_lengths": [70, 20, 49, 82, 135, 119, 98, 94, 87, 81, 73, 59, 17, 137, 39, 134, 152, 75, 19, 139, 14, 37, 73, 133, 77, 55, 25, 75, 22, 22, 56, 35, 106, 76, 42, 69, 94, 104, 125, 125, 114, 96, 266, 105, 51, 132, 147, 156, 251, 185, 180, 44, 112, 109, 119, 94, 87, 196, 29, 188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5202489348373143, "mean_inference_ms": 1.6564822391807945, "mean_action_processing_ms": 0.12404894058155479, "mean_env_wait_ms": 0.0635432380670549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005601167678833008, "StateBufferConnector_ms": 0.004250288009643555, "ViewRequirementAgentConnector_ms": 0.29653024673461914}}, "episode_reward_max": 500.0, "episode_reward_min": 14.0, "episode_reward_mean": 146.53, "episode_len_mean": 146.53, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [70.0, 20.0, 49.0, 82.0, 135.0, 119.0, 98.0, 94.0, 87.0, 81.0, 73.0, 59.0, 17.0, 137.0, 39.0, 134.0, 152.0, 75.0, 19.0, 139.0, 14.0, 37.0, 73.0, 133.0, 77.0, 55.0, 25.0, 75.0, 22.0, 22.0, 56.0, 35.0, 106.0, 76.0, 42.0, 69.0, 94.0, 104.0, 125.0, 125.0, 114.0, 96.0, 266.0, 105.0, 51.0, 132.0, 147.0, 156.0, 251.0, 185.0, 180.0, 44.0, 112.0, 109.0, 119.0, 94.0, 87.0, 196.0, 29.0, 188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0], "episode_lengths": [70, 20, 49, 82, 135, 119, 98, 94, 87, 81, 73, 59, 17, 137, 39, 134, 152, 75, 19, 139, 14, 37, 73, 133, 77, 55, 25, 75, 22, 22, 56, 35, 106, 76, 42, 69, 94, 104, 125, 125, 114, 96, 266, 105, 51, 132, 147, 156, 251, 185, 180, 44, 112, 109, 119, 94, 87, 196, 29, 188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5202489348373143, "mean_inference_ms": 1.6564822391807945, "mean_action_processing_ms": 0.12404894058155479, "mean_env_wait_ms": 0.0635432380670549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005601167678833008, "StateBufferConnector_ms": 0.004250288009643555, "ViewRequirementAgentConnector_ms": 0.29653024673461914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 263.7468389930933, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 24000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 15262.242, "sample_time_ms": 9513.463, "synch_weights_time_ms": 3.287}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 426, "training_iteration": 6, "trial_id": "33eb6_00000", "date": "2023-07-30_13-54-01", "timestamp": 1690725241, "time_this_iter_s": 35.483723878860474, "time_total_s": 127.30460381507874, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 127.30460381507874, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 33.62549019607843, "ram_util_percent": 83.40392156862745}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.889430684575649}, "default_policy": {"total_loss": 9.889430684575649, "policy_loss": -0.0034986724133795892, "vf_loss": 9.891790602507113, "vf_loss_unclipped": 4334.033319208922, "vf_explained_var": -0.1657805181642585, "entropy": 0.5284437760551856, "mean_kl_loss": 0.0037958682444187947, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.15000000596046448}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 14.0, "episode_reward_mean": 177.6, "episode_len_mean": 177.6, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [87.0, 81.0, 73.0, 59.0, 17.0, 137.0, 39.0, 134.0, 152.0, 75.0, 19.0, 139.0, 14.0, 37.0, 73.0, 133.0, 77.0, 55.0, 25.0, 75.0, 22.0, 22.0, 56.0, 35.0, 106.0, 76.0, 42.0, 69.0, 94.0, 104.0, 125.0, 125.0, 114.0, 96.0, 266.0, 105.0, 51.0, 132.0, 147.0, 156.0, 251.0, 185.0, 180.0, 44.0, 112.0, 109.0, 119.0, 94.0, 87.0, 196.0, 29.0, 188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0], "episode_lengths": [87, 81, 73, 59, 17, 137, 39, 134, 152, 75, 19, 139, 14, 37, 73, 133, 77, 55, 25, 75, 22, 22, 56, 35, 106, 76, 42, 69, 94, 104, 125, 125, 114, 96, 266, 105, 51, 132, 147, 156, 251, 185, 180, 44, 112, 109, 119, 94, 87, 196, 29, 188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5189366551078605, "mean_inference_ms": 1.6570444961131827, "mean_action_processing_ms": 0.12408153145169015, "mean_env_wait_ms": 0.0635425991724114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005555152893066406, "StateBufferConnector_ms": 0.004247426986694336, "ViewRequirementAgentConnector_ms": 0.29697442054748535}}, "episode_reward_max": 500.0, "episode_reward_min": 14.0, "episode_reward_mean": 177.6, "episode_len_mean": 177.6, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [87.0, 81.0, 73.0, 59.0, 17.0, 137.0, 39.0, 134.0, 152.0, 75.0, 19.0, 139.0, 14.0, 37.0, 73.0, 133.0, 77.0, 55.0, 25.0, 75.0, 22.0, 22.0, 56.0, 35.0, 106.0, 76.0, 42.0, 69.0, 94.0, 104.0, 125.0, 125.0, 114.0, 96.0, 266.0, 105.0, 51.0, 132.0, 147.0, 156.0, 251.0, 185.0, 180.0, 44.0, 112.0, 109.0, 119.0, 94.0, 87.0, 196.0, 29.0, 188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0], "episode_lengths": [87, 81, 73, 59, 17, 137, 39, 134, 152, 75, 19, 139, 14, 37, 73, 133, 77, 55, 25, 75, 22, 22, 56, 35, 106, 76, 42, 69, 94, 104, 125, 125, 114, 96, 266, 105, 51, 132, 147, 156, 251, 185, 180, 44, 112, 109, 119, 94, 87, 196, 29, 188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5189366551078605, "mean_inference_ms": 1.6570444961131827, "mean_action_processing_ms": 0.12408153145169015, "mean_env_wait_ms": 0.0635425991724114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005555152893066406, "StateBufferConnector_ms": 0.004247426986694336, "ViewRequirementAgentConnector_ms": 0.29697442054748535}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 265.8542452305472, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 28000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 15231.32, "sample_time_ms": 9486.348, "synch_weights_time_ms": 3.306}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 434, "training_iteration": 7, "trial_id": "33eb6_00000", "date": "2023-07-30_13-54-16", "timestamp": 1690725256, "time_this_iter_s": 15.050657749176025, "time_total_s": 142.35526156425476, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 142.35526156425476, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 32.595238095238095, "ram_util_percent": 83.44761904761906}}
{"evaluation": {"sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 53.0, "episode_reward_mean": 464.95, "episode_len_mean": 464.95, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 464.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 362.0, 500.0, 500.0, 420.0, 53.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 464, 500, 500, 500, 500, 500, 500, 500, 500, 362, 500, 500, 420, 53, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4953744589156182, "mean_inference_ms": 1.6270762724981196, "mean_action_processing_ms": 0.12157238097233777, "mean_env_wait_ms": 0.06222950166067002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005193948745727539, "StateBufferConnector_ms": 0.00396728515625, "ViewRequirementAgentConnector_ms": 0.29166698455810547}}, "episode_reward_max": 500.0, "episode_reward_min": 53.0, "episode_reward_mean": 464.95, "episode_len_mean": 464.95, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 464.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 362.0, 500.0, 500.0, 420.0, 53.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 464, 500, 500, 500, 500, 500, 500, 500, 500, 362, 500, 500, 420, 53, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4953744589156182, "mean_inference_ms": 1.6270762724981196, "mean_action_processing_ms": 0.12157238097233777, "mean_env_wait_ms": 0.06222950166067002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005193948745727539, "StateBufferConnector_ms": 0.00396728515625, "ViewRequirementAgentConnector_ms": 0.29166698455810547}, "num_agent_steps_sampled_this_iter": 9299, "num_env_steps_sampled_this_iter": 9299, "timesteps_this_iter": 9299, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.86749372502634}, "default_policy": {"total_loss": 9.86749372502634, "policy_loss": -0.003564379810452906, "vf_loss": 9.870420416280913, "vf_loss_unclipped": 3858.837760225796, "vf_explained_var": -0.15276143717359125, "entropy": 0.5377197262130058, "mean_kl_loss": 0.004251320924827554, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 14.0, "episode_reward_mean": 212.83, "episode_len_mean": 212.83, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.0, 19.0, 139.0, 14.0, 37.0, 73.0, 133.0, 77.0, 55.0, 25.0, 75.0, 22.0, 22.0, 56.0, 35.0, 106.0, 76.0, 42.0, 69.0, 94.0, 104.0, 125.0, 125.0, 114.0, 96.0, 266.0, 105.0, 51.0, 132.0, 147.0, 156.0, 251.0, 185.0, 180.0, 44.0, 112.0, 109.0, 119.0, 94.0, 87.0, 196.0, 29.0, 188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0], "episode_lengths": [75, 19, 139, 14, 37, 73, 133, 77, 55, 25, 75, 22, 22, 56, 35, 106, 76, 42, 69, 94, 104, 125, 125, 114, 96, 266, 105, 51, 132, 147, 156, 251, 185, 180, 44, 112, 109, 119, 94, 87, 196, 29, 188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5173572261393101, "mean_inference_ms": 1.6575692635083, "mean_action_processing_ms": 0.12412569961211639, "mean_env_wait_ms": 0.06353038667276455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005570888519287109, "StateBufferConnector_ms": 0.0042591094970703125, "ViewRequirementAgentConnector_ms": 0.2979893684387207}}, "episode_reward_max": 500.0, "episode_reward_min": 14.0, "episode_reward_mean": 212.83, "episode_len_mean": 212.83, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [75.0, 19.0, 139.0, 14.0, 37.0, 73.0, 133.0, 77.0, 55.0, 25.0, 75.0, 22.0, 22.0, 56.0, 35.0, 106.0, 76.0, 42.0, 69.0, 94.0, 104.0, 125.0, 125.0, 114.0, 96.0, 266.0, 105.0, 51.0, 132.0, 147.0, 156.0, 251.0, 185.0, 180.0, 44.0, 112.0, 109.0, 119.0, 94.0, 87.0, 196.0, 29.0, 188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0], "episode_lengths": [75, 19, 139, 14, 37, 73, 133, 77, 55, 25, 75, 22, 22, 56, 35, 106, 76, 42, 69, 94, 104, 125, 125, 114, 96, 266, 105, 51, 132, 147, 156, 251, 185, 180, 44, 112, 109, 119, 94, 87, 196, 29, 188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5173572261393101, "mean_inference_ms": 1.6575692635083, "mean_action_processing_ms": 0.12412569961211639, "mean_env_wait_ms": 0.06353038667276455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005570888519287109, "StateBufferConnector_ms": 0.0042591094970703125, "ViewRequirementAgentConnector_ms": 0.2979893684387207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 266.05824052021336, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 32000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 15206.687, "sample_time_ms": 9476.35, "synch_weights_time_ms": 3.256}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 443, "training_iteration": 8, "trial_id": "33eb6_00000", "date": "2023-07-30_13-54-53", "timestamp": 1690725293, "time_this_iter_s": 36.59631371498108, "time_total_s": 178.95157527923584, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 178.95157527923584, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 33.21153846153846, "ram_util_percent": 83.44615384615386}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.841583614918724}, "default_policy": {"total_loss": 9.841583614918724, "policy_loss": -0.007414147638078374, "vf_loss": 9.848196909117545, "vf_loss_unclipped": 3384.863028715414, "vf_explained_var": -0.0806075413979447, "entropy": 0.5227226634968573, "mean_kl_loss": 0.010678043445082457, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 17.0, "episode_reward_mean": 246.47, "episode_len_mean": 246.47, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.0, 75.0, 22.0, 22.0, 56.0, 35.0, 106.0, 76.0, 42.0, 69.0, 94.0, 104.0, 125.0, 125.0, 114.0, 96.0, 266.0, 105.0, 51.0, 132.0, 147.0, 156.0, 251.0, 185.0, 180.0, 44.0, 112.0, 109.0, 119.0, 94.0, 87.0, 196.0, 29.0, 188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0], "episode_lengths": [25, 75, 22, 22, 56, 35, 106, 76, 42, 69, 94, 104, 125, 125, 114, 96, 266, 105, 51, 132, 147, 156, 251, 185, 180, 44, 112, 109, 119, 94, 87, 196, 29, 188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5157374947851525, "mean_inference_ms": 1.657899868403155, "mean_action_processing_ms": 0.1241536036288134, "mean_env_wait_ms": 0.06350556834428549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005512237548828125, "StateBufferConnector_ms": 0.004229068756103516, "ViewRequirementAgentConnector_ms": 0.2992849349975586}}, "episode_reward_max": 500.0, "episode_reward_min": 17.0, "episode_reward_mean": 246.47, "episode_len_mean": 246.47, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.0, 75.0, 22.0, 22.0, 56.0, 35.0, 106.0, 76.0, 42.0, 69.0, 94.0, 104.0, 125.0, 125.0, 114.0, 96.0, 266.0, 105.0, 51.0, 132.0, 147.0, 156.0, 251.0, 185.0, 180.0, 44.0, 112.0, 109.0, 119.0, 94.0, 87.0, 196.0, 29.0, 188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0], "episode_lengths": [25, 75, 22, 22, 56, 35, 106, 76, 42, 69, 94, 104, 125, 125, 114, 96, 266, 105, 51, 132, 147, 156, 251, 185, 180, 44, 112, 109, 119, 94, 87, 196, 29, 188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5157374947851525, "mean_inference_ms": 1.657899868403155, "mean_action_processing_ms": 0.1241536036288134, "mean_env_wait_ms": 0.06350556834428549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005512237548828125, "StateBufferConnector_ms": 0.004229068756103516, "ViewRequirementAgentConnector_ms": 0.2992849349975586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.79067380648996, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 36000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 15195.525, "sample_time_ms": 9464.377, "synch_weights_time_ms": 3.247}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 452, "training_iteration": 9, "trial_id": "33eb6_00000", "date": "2023-07-30_13-55-08", "timestamp": 1690725308, "time_this_iter_s": 15.110408067703247, "time_total_s": 194.0619833469391, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 194.0619833469391, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 32.91363636363636, "ram_util_percent": 83.55000000000001}}
{"evaluation": {"sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 227.0, "episode_reward_mean": 481.8, "episode_len_mean": 481.8, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 227.0, 500.0, 500.0, 409.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 227, 500, 500, 409, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4947052397347864, "mean_inference_ms": 1.623280173912362, "mean_action_processing_ms": 0.12123563198023087, "mean_env_wait_ms": 0.062168058108098945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005154609680175781, "StateBufferConnector_ms": 0.003902912139892578, "ViewRequirementAgentConnector_ms": 0.28876781463623047}}, "episode_reward_max": 500.0, "episode_reward_min": 227.0, "episode_reward_mean": 481.8, "episode_len_mean": 481.8, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 227.0, 500.0, 500.0, 409.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 227, 500, 500, 409, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4947052397347864, "mean_inference_ms": 1.623280173912362, "mean_action_processing_ms": 0.12123563198023087, "mean_env_wait_ms": 0.062168058108098945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005154609680175781, "StateBufferConnector_ms": 0.003902912139892578, "ViewRequirementAgentConnector_ms": 0.28876781463623047}, "num_agent_steps_sampled_this_iter": 9636, "num_env_steps_sampled_this_iter": 9636, "timesteps_this_iter": 9636, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.87549831414782}, "default_policy": {"total_loss": 9.87549831414782, "policy_loss": -0.0018308104655302283, "vf_loss": 9.877112864431288, "vf_loss_unclipped": 3184.899023906, "vf_explained_var": -0.1058902953987691, "entropy": 0.5195242456281617, "mean_kl_loss": 0.0028837693871643995, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.03750000149011612}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 17.0, "episode_reward_mean": 280.55, "episode_len_mean": 280.55, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.0, 69.0, 94.0, 104.0, 125.0, 125.0, 114.0, 96.0, 266.0, 105.0, 51.0, 132.0, 147.0, 156.0, 251.0, 185.0, 180.0, 44.0, 112.0, 109.0, 119.0, 94.0, 87.0, 196.0, 29.0, 188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [42, 69, 94, 104, 125, 125, 114, 96, 266, 105, 51, 132, 147, 156, 251, 185, 180, 44, 112, 109, 119, 94, 87, 196, 29, 188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5141684986112446, "mean_inference_ms": 1.6582767779847989, "mean_action_processing_ms": 0.12420174035274666, "mean_env_wait_ms": 0.06358529560481868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005503177642822266, "StateBufferConnector_ms": 0.0042345523834228516, "ViewRequirementAgentConnector_ms": 0.29822587966918945}}, "episode_reward_max": 500.0, "episode_reward_min": 17.0, "episode_reward_mean": 280.55, "episode_len_mean": 280.55, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.0, 69.0, 94.0, 104.0, 125.0, 125.0, 114.0, 96.0, 266.0, 105.0, 51.0, 132.0, 147.0, 156.0, 251.0, 185.0, 180.0, 44.0, 112.0, 109.0, 119.0, 94.0, 87.0, 196.0, 29.0, 188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [42, 69, 94, 104, 125, 125, 114, 96, 266, 105, 51, 132, 147, 156, 251, 185, 180, 44, 112, 109, 119, 94, 87, 196, 29, 188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5141684986112446, "mean_inference_ms": 1.6582767779847989, "mean_action_processing_ms": 0.12420174035274666, "mean_env_wait_ms": 0.06358529560481868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005503177642822266, "StateBufferConnector_ms": 0.0042345523834228516, "ViewRequirementAgentConnector_ms": 0.29822587966918945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 263.3882708843079, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 40000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 15194.638, "sample_time_ms": 9468.165, "synch_weights_time_ms": 3.231}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 460, "training_iteration": 10, "trial_id": "33eb6_00000", "date": "2023-07-30_13-55-45", "timestamp": 1690725345, "time_this_iter_s": 37.38563513755798, "time_total_s": 231.44761848449707, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 231.44761848449707, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 32.58867924528302, "ram_util_percent": 83.38490566037737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.856590264895832}, "default_policy": {"total_loss": 9.856590264895832, "policy_loss": -0.004249366506664102, "vf_loss": 9.860554033250951, "vf_loss_unclipped": 2873.817267346738, "vf_explained_var": -0.08410269968799436, "entropy": 0.5170389257832122, "mean_kl_loss": 0.007615910779523648, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.03750000149011612}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 17.0, "episode_reward_mean": 312.4, "episode_len_mean": 312.4, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [266.0, 105.0, 51.0, 132.0, 147.0, 156.0, 251.0, 185.0, 180.0, 44.0, 112.0, 109.0, 119.0, 94.0, 87.0, 196.0, 29.0, 188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 454.0], "episode_lengths": [266, 105, 51, 132, 147, 156, 251, 185, 180, 44, 112, 109, 119, 94, 87, 196, 29, 188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 454]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5126958764321907, "mean_inference_ms": 1.658145092992956, "mean_action_processing_ms": 0.12421331000594972, "mean_env_wait_ms": 0.06363995240199072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005307674407958984, "StateBufferConnector_ms": 0.004221200942993164, "ViewRequirementAgentConnector_ms": 0.29718661308288574}}, "episode_reward_max": 500.0, "episode_reward_min": 17.0, "episode_reward_mean": 312.4, "episode_len_mean": 312.4, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [266.0, 105.0, 51.0, 132.0, 147.0, 156.0, 251.0, 185.0, 180.0, 44.0, 112.0, 109.0, 119.0, 94.0, 87.0, 196.0, 29.0, 188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 454.0], "episode_lengths": [266, 105, 51, 132, 147, 156, 251, 185, 180, 44, 112, 109, 119, 94, 87, 196, 29, 188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 454]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5126958764321907, "mean_inference_ms": 1.658145092992956, "mean_action_processing_ms": 0.12421331000594972, "mean_env_wait_ms": 0.06363995240199072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005307674407958984, "StateBufferConnector_ms": 0.004221200942993164, "ViewRequirementAgentConnector_ms": 0.29718661308288574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 269.646618006823, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 44000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 15099.115, "sample_time_ms": 9419.325, "synch_weights_time_ms": 3.297}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 468, "training_iteration": 11, "trial_id": "33eb6_00000", "date": "2023-07-30_13-56-00", "timestamp": 1690725360, "time_this_iter_s": 14.839055061340332, "time_total_s": 246.2866735458374, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 246.2866735458374, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 31.638095238095243, "ram_util_percent": 83.23809523809526}}
{"evaluation": {"sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 438.0, "episode_reward_mean": 496.9, "episode_len_mean": 496.9, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 438.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 438, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49459226567573406, "mean_inference_ms": 1.6283328930500975, "mean_action_processing_ms": 0.1214900201327849, "mean_env_wait_ms": 0.062042069980556835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051724910736083984, "StateBufferConnector_ms": 0.003801584243774414, "ViewRequirementAgentConnector_ms": 0.28382420539855957}}, "episode_reward_max": 500.0, "episode_reward_min": 438.0, "episode_reward_mean": 496.9, "episode_len_mean": 496.9, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 438.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 438, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49459226567573406, "mean_inference_ms": 1.6283328930500975, "mean_action_processing_ms": 0.1214900201327849, "mean_env_wait_ms": 0.062042069980556835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051724910736083984, "StateBufferConnector_ms": 0.003801584243774414, "ViewRequirementAgentConnector_ms": 0.28382420539855957}, "num_agent_steps_sampled_this_iter": 9938, "num_env_steps_sampled_this_iter": 9938, "timesteps_this_iter": 9938, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.833743632221019}, "default_policy": {"total_loss": 9.833743632221019, "policy_loss": -0.004115250946056328, "vf_loss": 9.837620441339164, "vf_loss_unclipped": 2414.8618039454477, "vf_explained_var": -0.060533793114904144, "entropy": 0.5287546823337388, "mean_kl_loss": 0.006358327683150572, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.03750000149011612}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 17.0, "episode_reward_mean": 338.34, "episode_len_mean": 338.34, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 112.0, 109.0, 119.0, 94.0, 87.0, 196.0, 29.0, 188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 454.0, 500.0, 231.0, 379.0, 500.0, 500.0, 500.0, 500.0, 457.0, 500.0], "episode_lengths": [44, 112, 109, 119, 94, 87, 196, 29, 188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 454, 500, 231, 379, 500, 500, 500, 500, 457, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5111227953259956, "mean_inference_ms": 1.6576777460028886, "mean_action_processing_ms": 0.12420818868412743, "mean_env_wait_ms": 0.06368318652043381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005306720733642578, "StateBufferConnector_ms": 0.0041697025299072266, "ViewRequirementAgentConnector_ms": 0.29578518867492676}}, "episode_reward_max": 500.0, "episode_reward_min": 17.0, "episode_reward_mean": 338.34, "episode_len_mean": 338.34, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.0, 112.0, 109.0, 119.0, 94.0, 87.0, 196.0, 29.0, 188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 454.0, 500.0, 231.0, 379.0, 500.0, 500.0, 500.0, 500.0, 457.0, 500.0], "episode_lengths": [44, 112, 109, 119, 94, 87, 196, 29, 188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 454, 500, 231, 379, 500, 500, 500, 500, 457, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5111227953259956, "mean_inference_ms": 1.6576777460028886, "mean_action_processing_ms": 0.12420818868412743, "mean_env_wait_ms": 0.06368318652043381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005306720733642578, "StateBufferConnector_ms": 0.0041697025299072266, "ViewRequirementAgentConnector_ms": 0.29578518867492676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 266.69749722317545, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 48000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 15066.502, "sample_time_ms": 9390.62, "synch_weights_time_ms": 3.267}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 477, "training_iteration": 12, "trial_id": "33eb6_00000", "date": "2023-07-30_13-56-38", "timestamp": 1690725398, "time_this_iter_s": 38.239458084106445, "time_total_s": 284.52613162994385, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 284.52613162994385, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 33.720370370370375, "ram_util_percent": 83.38518518518516}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.850435893418693}, "default_policy": {"total_loss": 9.850435893418693, "policy_loss": -0.003754362753872424, "vf_loss": 9.853824623612198, "vf_loss_unclipped": 2321.384457390954, "vf_explained_var": -0.04018235079515209, "entropy": 0.5003052435513499, "mean_kl_loss": 0.009749873301493324, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.03750000149011612}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 17.0, "episode_reward_mean": 370.44, "episode_len_mean": 370.44, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 454.0, 500.0, 231.0, 379.0, 500.0, 500.0, 500.0, 500.0, 457.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 454, 500, 231, 379, 500, 500, 500, 500, 457, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5097335951461328, "mean_inference_ms": 1.6575362129703495, "mean_action_processing_ms": 0.12423129205583955, "mean_env_wait_ms": 0.06372324584411296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005355119705200195, "StateBufferConnector_ms": 0.0041961669921875, "ViewRequirementAgentConnector_ms": 0.2983856201171875}}, "episode_reward_max": 500.0, "episode_reward_min": 17.0, "episode_reward_mean": 370.44, "episode_len_mean": 370.44, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [188.0, 71.0, 134.0, 64.0, 83.0, 119.0, 60.0, 18.0, 166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 454.0, 500.0, 231.0, 379.0, 500.0, 500.0, 500.0, 500.0, 457.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [188, 71, 134, 64, 83, 119, 60, 18, 166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 454, 500, 231, 379, 500, 500, 500, 500, 457, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5097335951461328, "mean_inference_ms": 1.6575362129703495, "mean_action_processing_ms": 0.12423129205583955, "mean_env_wait_ms": 0.06372324584411296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005355119705200195, "StateBufferConnector_ms": 0.0041961669921875, "ViewRequirementAgentConnector_ms": 0.2983856201171875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 261.0735251200787, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 52000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 15099.117, "sample_time_ms": 9421.795, "synch_weights_time_ms": 3.318}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 485, "training_iteration": 13, "trial_id": "33eb6_00000", "date": "2023-07-30_13-56-54", "timestamp": 1690725414, "time_this_iter_s": 15.327750444412231, "time_total_s": 299.8538820743561, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 299.8538820743561, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.554545454545455, "ram_util_percent": 83.25909090909093}}
{"evaluation": {"sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 335.0, "episode_reward_mean": 466.15, "episode_len_mean": 466.15, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 335.0, 500.0, 500.0, 353.0, 372.0, 446.0, 500.0, 500.0, 500.0, 397.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 420, 500, 500, 500, 500, 335, 500, 500, 353, 372, 446, 500, 500, 500, 397, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49458831817450893, "mean_inference_ms": 1.6291302165110118, "mean_action_processing_ms": 0.12167626903011645, "mean_env_wait_ms": 0.06216484338624371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005135536193847656, "StateBufferConnector_ms": 0.003814697265625, "ViewRequirementAgentConnector_ms": 0.2896714210510254}}, "episode_reward_max": 500.0, "episode_reward_min": 335.0, "episode_reward_mean": 466.15, "episode_len_mean": 466.15, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 420.0, 500.0, 500.0, 500.0, 500.0, 335.0, 500.0, 500.0, 353.0, 372.0, 446.0, 500.0, 500.0, 500.0, 397.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 420, 500, 500, 500, 500, 335, 500, 500, 353, 372, 446, 500, 500, 500, 397, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49458831817450893, "mean_inference_ms": 1.6291302165110118, "mean_action_processing_ms": 0.12167626903011645, "mean_env_wait_ms": 0.06216484338624371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005135536193847656, "StateBufferConnector_ms": 0.003814697265625, "ViewRequirementAgentConnector_ms": 0.2896714210510254}, "num_agent_steps_sampled_this_iter": 9323, "num_env_steps_sampled_this_iter": 9323, "timesteps_this_iter": 9323, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.831914172752072}, "default_policy": {"total_loss": 9.831914172752072, "policy_loss": -0.0022753443060589754, "vf_loss": 9.833998248012843, "vf_loss_unclipped": 1991.8716678904063, "vf_explained_var": 0.03098456812565769, "entropy": 0.4938639112309352, "mean_kl_loss": 0.005100248118040592, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.03750000149011612}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 17.0, "episode_reward_mean": 400.33, "episode_len_mean": 400.33, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 454.0, 500.0, 231.0, 379.0, 500.0, 500.0, 500.0, 500.0, 457.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 324.0, 402.0, 500.0, 500.0], "episode_lengths": [166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 454, 500, 231, 379, 500, 500, 500, 500, 457, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 324, 402, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.508324611898055, "mean_inference_ms": 1.6574260870536472, "mean_action_processing_ms": 0.12428114660147066, "mean_env_wait_ms": 0.06375800507726981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005364894866943359, "StateBufferConnector_ms": 0.004169464111328125, "ViewRequirementAgentConnector_ms": 0.299466609954834}}, "episode_reward_max": 500.0, "episode_reward_min": 17.0, "episode_reward_mean": 400.33, "episode_len_mean": 400.33, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [166.0, 220.0, 18.0, 215.0, 256.0, 17.0, 107.0, 146.0, 229.0, 214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 454.0, 500.0, 231.0, 379.0, 500.0, 500.0, 500.0, 500.0, 457.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 324.0, 402.0, 500.0, 500.0], "episode_lengths": [166, 220, 18, 215, 256, 17, 107, 146, 229, 214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 454, 500, 231, 379, 500, 500, 500, 500, 457, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 324, 402, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.508324611898055, "mean_inference_ms": 1.6574260870536472, "mean_action_processing_ms": 0.12428114660147066, "mean_env_wait_ms": 0.06375800507726981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005364894866943359, "StateBufferConnector_ms": 0.004169464111328125, "ViewRequirementAgentConnector_ms": 0.299466609954834}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.336272879123, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 56000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 15103.244, "sample_time_ms": 9417.324, "synch_weights_time_ms": 3.302}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 493, "training_iteration": 14, "trial_id": "33eb6_00000", "date": "2023-07-30_13-57-31", "timestamp": 1690725451, "time_this_iter_s": 36.83424210548401, "time_total_s": 336.6881241798401, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 336.6881241798401, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 34.11698113207547, "ram_util_percent": 83.41132075471697}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.796960381302497}, "default_policy": {"total_loss": 9.796960381302497, "policy_loss": -0.005250394506665912, "vf_loss": 9.801922242016172, "vf_loss_unclipped": 1688.4969676328874, "vf_explained_var": -0.0016653776677178422, "entropy": 0.5096597704234154, "mean_kl_loss": 0.007693434171355604, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.03750000149011612}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 135.0, "episode_reward_mean": 428.86, "episode_len_mean": 428.86, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 454.0, 500.0, 231.0, 379.0, 500.0, 500.0, 500.0, 500.0, 457.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 324.0, 402.0, 500.0, 500.0, 500.0, 439.0, 500.0, 500.0, 500.0, 425.0, 500.0, 500.0, 363.0], "episode_lengths": [214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 454, 500, 231, 379, 500, 500, 500, 500, 457, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 324, 402, 500, 500, 500, 439, 500, 500, 500, 425, 500, 500, 363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5069704542229908, "mean_inference_ms": 1.6572020149492295, "mean_action_processing_ms": 0.12432052093553118, "mean_env_wait_ms": 0.06379623589361598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005378007888793945, "StateBufferConnector_ms": 0.004186868667602539, "ViewRequirementAgentConnector_ms": 0.30237269401550293}}, "episode_reward_max": 500.0, "episode_reward_min": 135.0, "episode_reward_mean": 428.86, "episode_len_mean": 428.86, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [214.0, 140.0, 230.0, 204.0, 180.0, 154.0, 212.0, 203.0, 396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 454.0, 500.0, 231.0, 379.0, 500.0, 500.0, 500.0, 500.0, 457.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 324.0, 402.0, 500.0, 500.0, 500.0, 439.0, 500.0, 500.0, 500.0, 425.0, 500.0, 500.0, 363.0], "episode_lengths": [214, 140, 230, 204, 180, 154, 212, 203, 396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 454, 500, 231, 379, 500, 500, 500, 500, 457, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 324, 402, 500, 500, 500, 439, 500, 500, 500, 425, 500, 500, 363]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5069704542229908, "mean_inference_ms": 1.6572020149492295, "mean_action_processing_ms": 0.12432052093553118, "mean_env_wait_ms": 0.06379623589361598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005378007888793945, "StateBufferConnector_ms": 0.004186868667602539, "ViewRequirementAgentConnector_ms": 0.30237269401550293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 263.83817500371407, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 60000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 15098.562, "sample_time_ms": 9415.317, "synch_weights_time_ms": 3.265}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 502, "training_iteration": 15, "trial_id": "33eb6_00000", "date": "2023-07-30_13-57-46", "timestamp": 1690725466, "time_this_iter_s": 15.164735555648804, "time_total_s": 351.8528597354889, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 351.8528597354889, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 33.95238095238096, "ram_util_percent": 83.66190476190476}}
{"evaluation": {"sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 207.0, "episode_reward_mean": 477.6, "episode_len_mean": 477.6, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 207.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 345.0], "episode_lengths": [500, 207, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 345]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49468620262696633, "mean_inference_ms": 1.629226467756776, "mean_action_processing_ms": 0.12162919789545605, "mean_env_wait_ms": 0.06218141351273003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006597042083740234, "StateBufferConnector_ms": 0.0039017200469970703, "ViewRequirementAgentConnector_ms": 0.30422329902648926}}, "episode_reward_max": 500.0, "episode_reward_min": 207.0, "episode_reward_mean": 477.6, "episode_len_mean": 477.6, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 207.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 345.0], "episode_lengths": [500, 207, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 345]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49468620262696633, "mean_inference_ms": 1.629226467756776, "mean_action_processing_ms": 0.12162919789545605, "mean_env_wait_ms": 0.06218141351273003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006597042083740234, "StateBufferConnector_ms": 0.0039017200469970703, "ViewRequirementAgentConnector_ms": 0.30422329902648926}, "num_agent_steps_sampled_this_iter": 9552, "num_env_steps_sampled_this_iter": 9552, "timesteps_this_iter": 9552, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.81863084581615}, "default_policy": {"total_loss": 9.81863084581615, "policy_loss": -0.0019418865254621452, "vf_loss": 9.820408695033873, "vf_loss_unclipped": 1579.4545070103236, "vf_explained_var": -0.02876002498781249, "entropy": 0.5068265546295943, "mean_kl_loss": 0.004374066313534292, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.01875000074505806}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 135.0, "episode_reward_mean": 453.49, "episode_len_mean": 453.49, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 454.0, 500.0, 231.0, 379.0, 500.0, 500.0, 500.0, 500.0, 457.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 324.0, 402.0, 500.0, 500.0, 500.0, 439.0, 500.0, 500.0, 500.0, 425.0, 500.0, 500.0, 363.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 454, 500, 231, 379, 500, 500, 500, 500, 457, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 324, 402, 500, 500, 500, 439, 500, 500, 500, 425, 500, 500, 363, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5058662972176291, "mean_inference_ms": 1.6570045428794016, "mean_action_processing_ms": 0.1243508288315173, "mean_env_wait_ms": 0.06382736061450976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00529789924621582, "StateBufferConnector_ms": 0.0041637420654296875, "ViewRequirementAgentConnector_ms": 0.2999856472015381}}, "episode_reward_max": 500.0, "episode_reward_min": 135.0, "episode_reward_mean": 453.49, "episode_len_mean": 453.49, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [396.0, 255.0, 153.0, 135.0, 335.0, 165.0, 476.0, 327.0, 500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 454.0, 500.0, 231.0, 379.0, 500.0, 500.0, 500.0, 500.0, 457.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 324.0, 402.0, 500.0, 500.0, 500.0, 439.0, 500.0, 500.0, 500.0, 425.0, 500.0, 500.0, 363.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [396, 255, 153, 135, 335, 165, 476, 327, 500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 454, 500, 231, 379, 500, 500, 500, 500, 457, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 324, 402, 500, 500, 500, 439, 500, 500, 500, 425, 500, 500, 363, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5058662972176291, "mean_inference_ms": 1.6570045428794016, "mean_action_processing_ms": 0.1243508288315173, "mean_env_wait_ms": 0.06382736061450976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00529789924621582, "StateBufferConnector_ms": 0.0041637420654296875, "ViewRequirementAgentConnector_ms": 0.2999856472015381}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 261.72882039011773, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 64000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 15110.256, "sample_time_ms": 9415.157, "synch_weights_time_ms": 3.227}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 510, "training_iteration": 16, "trial_id": "33eb6_00000", "date": "2023-07-30_13-58-23", "timestamp": 1690725503, "time_this_iter_s": 37.47906756401062, "time_total_s": 389.3319272994995, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 389.3319272994995, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 33.464814814814815, "ram_util_percent": 83.58333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.80387618241788}, "default_policy": {"total_loss": 9.80387618241788, "policy_loss": -0.0016501559587969964, "vf_loss": 9.805455890037358, "vf_loss_unclipped": 1353.739540246504, "vf_explained_var": -0.045639414332314596, "entropy": 0.509196232440375, "mean_kl_loss": 0.0037578630496290276, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.00937500037252903}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 207.0, "episode_reward_mean": 471.07, "episode_len_mean": 471.07, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 454.0, 500.0, 231.0, 379.0, 500.0, 500.0, 500.0, 500.0, 457.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 324.0, 402.0, 500.0, 500.0, 500.0, 439.0, 500.0, 500.0, 500.0, 425.0, 500.0, 500.0, 363.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 454, 500, 231, 379, 500, 500, 500, 500, 457, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 324, 402, 500, 500, 500, 439, 500, 500, 500, 425, 500, 500, 363, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5047777875321353, "mean_inference_ms": 1.6567485318446693, "mean_action_processing_ms": 0.12437602303587734, "mean_env_wait_ms": 0.06385412393989927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005223512649536133, "StateBufferConnector_ms": 0.004147768020629883, "ViewRequirementAgentConnector_ms": 0.298494815826416}}, "episode_reward_max": 500.0, "episode_reward_min": 207.0, "episode_reward_mean": 471.07, "episode_len_mean": 471.07, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 283.0, 500.0, 383.0, 417.0, 279.0, 500.0, 384.0, 500.0, 500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 454.0, 500.0, 231.0, 379.0, 500.0, 500.0, 500.0, 500.0, 457.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 324.0, 402.0, 500.0, 500.0, 500.0, 439.0, 500.0, 500.0, 500.0, 425.0, 500.0, 500.0, 363.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 283, 500, 383, 417, 279, 500, 384, 500, 500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 454, 500, 231, 379, 500, 500, 500, 500, 457, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 324, 402, 500, 500, 500, 439, 500, 500, 500, 425, 500, 500, 363, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5047777875321353, "mean_inference_ms": 1.6567485318446693, "mean_action_processing_ms": 0.12437602303587734, "mean_env_wait_ms": 0.06385412393989927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005223512649536133, "StateBufferConnector_ms": 0.004147768020629883, "ViewRequirementAgentConnector_ms": 0.298494815826416}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 266.9130862506514, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 68000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 15104.287, "sample_time_ms": 9422.463, "synch_weights_time_ms": 3.203}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 518, "training_iteration": 17, "trial_id": "33eb6_00000", "date": "2023-07-30_13-58-38", "timestamp": 1690725518, "time_this_iter_s": 14.990446090698242, "time_total_s": 404.32237339019775, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 404.32237339019775, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 32.32380952380953, "ram_util_percent": 83.59523809523809}}
{"evaluation": {"sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 500.0, "episode_reward_mean": 500.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4946670694496376, "mean_inference_ms": 1.6301213652256277, "mean_action_processing_ms": 0.12171738543398716, "mean_env_wait_ms": 0.062255643102207034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054585933685302734, "StateBufferConnector_ms": 0.003955364227294922, "ViewRequirementAgentConnector_ms": 0.29161810874938965}}, "episode_reward_max": 500.0, "episode_reward_min": 500.0, "episode_reward_mean": 500.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4946670694496376, "mean_inference_ms": 1.6301213652256277, "mean_action_processing_ms": 0.12171738543398716, "mean_env_wait_ms": 0.062255643102207034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054585933685302734, "StateBufferConnector_ms": 0.003955364227294922, "ViewRequirementAgentConnector_ms": 0.29161810874938965}, "num_agent_steps_sampled_this_iter": 10000, "num_env_steps_sampled_this_iter": 10000, "timesteps_this_iter": 10000, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.72529513901993}, "default_policy": {"total_loss": 9.72529513901993, "policy_loss": -0.006202089365945061, "vf_loss": 9.731444442195933, "vf_loss_unclipped": 1048.134669395398, "vf_explained_var": -0.03270973141259476, "entropy": 0.5087042840114281, "mean_kl_loss": 0.005629849623312979, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.00937500037252903}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 207.0, "episode_reward_mean": 474.81, "episode_len_mean": 474.81, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 454.0, 500.0, 231.0, 379.0, 500.0, 500.0, 500.0, 500.0, 457.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 324.0, 402.0, 500.0, 500.0, 500.0, 439.0, 500.0, 500.0, 500.0, 425.0, 500.0, 500.0, 363.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 314.0, 500.0, 415.0, 500.0, 500.0, 500.0, 391.0, 500.0], "episode_lengths": [500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 454, 500, 231, 379, 500, 500, 500, 500, 457, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 324, 402, 500, 500, 500, 439, 500, 500, 500, 425, 500, 500, 363, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 314, 500, 415, 500, 500, 500, 391, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5037605271305522, "mean_inference_ms": 1.656411525744113, "mean_action_processing_ms": 0.12440535833432152, "mean_env_wait_ms": 0.06388617335479893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005312204360961914, "StateBufferConnector_ms": 0.004153728485107422, "ViewRequirementAgentConnector_ms": 0.2983129024505615}}, "episode_reward_max": 500.0, "episode_reward_min": 207.0, "episode_reward_mean": 474.81, "episode_len_mean": 474.81, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 451.0, 500.0, 323.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 454.0, 500.0, 231.0, 379.0, 500.0, 500.0, 500.0, 500.0, 457.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 324.0, 402.0, 500.0, 500.0, 500.0, 439.0, 500.0, 500.0, 500.0, 425.0, 500.0, 500.0, 363.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 314.0, 500.0, 415.0, 500.0, 500.0, 500.0, 391.0, 500.0], "episode_lengths": [500, 500, 500, 500, 451, 500, 323, 500, 500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 454, 500, 231, 379, 500, 500, 500, 500, 457, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 324, 402, 500, 500, 500, 439, 500, 500, 500, 425, 500, 500, 363, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 314, 500, 415, 500, 500, 500, 391, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5037605271305522, "mean_inference_ms": 1.656411525744113, "mean_action_processing_ms": 0.12440535833432152, "mean_env_wait_ms": 0.06388617335479893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005312204360961914, "StateBufferConnector_ms": 0.004153728485107422, "ViewRequirementAgentConnector_ms": 0.2983129024505615}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 262.98834050395925, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 72000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 15121.836, "sample_time_ms": 9431.001, "synch_weights_time_ms": 3.242}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 527, "training_iteration": 18, "trial_id": "33eb6_00000", "date": "2023-07-30_13-59-17", "timestamp": 1690725557, "time_this_iter_s": 38.51405692100525, "time_total_s": 442.836430311203, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 442.836430311203, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 33.40909090909091, "ram_util_percent": 83.65454545454547}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 4000.0, "total_loss": 9.750986611665185}, "default_policy": {"total_loss": 9.750986611665185, "policy_loss": -0.0038914912274039823, "vf_loss": 9.754842504001122, "vf_loss_unclipped": 893.3997122107793, "vf_explained_var": -0.08397272413473393, "entropy": 0.5292539340155974, "mean_kl_loss": 0.0038003752765098714, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.004687500186264515}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": 207.0, "episode_reward_mean": 476.42, "episode_len_mean": 476.42, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 454.0, 500.0, 231.0, 379.0, 500.0, 500.0, 500.0, 500.0, 457.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 324.0, 402.0, 500.0, 500.0, 500.0, 439.0, 500.0, 500.0, 500.0, 425.0, 500.0, 500.0, 363.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 314.0, 500.0, 415.0, 500.0, 500.0, 500.0, 391.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 435.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 454, 500, 231, 379, 500, 500, 500, 500, 457, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 324, 402, 500, 500, 500, 439, 500, 500, 500, 425, 500, 500, 363, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 314, 500, 415, 500, 500, 500, 391, 500, 500, 500, 500, 500, 500, 435, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5030812238499134, "mean_inference_ms": 1.6563421000351797, "mean_action_processing_ms": 0.12444791957644523, "mean_env_wait_ms": 0.0639249175561622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005317211151123047, "StateBufferConnector_ms": 0.004159688949584961, "ViewRequirementAgentConnector_ms": 0.2982957363128662}}, "episode_reward_max": 500.0, "episode_reward_min": 207.0, "episode_reward_mean": 476.42, "episode_len_mean": 476.42, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 302.0, 500.0, 500.0, 500.0, 500.0, 500.0, 350.0, 207.0, 429.0, 500.0, 500.0, 500.0, 325.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 454.0, 500.0, 231.0, 379.0, 500.0, 500.0, 500.0, 500.0, 457.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 324.0, 402.0, 500.0, 500.0, 500.0, 439.0, 500.0, 500.0, 500.0, 425.0, 500.0, 500.0, 363.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 314.0, 500.0, 415.0, 500.0, 500.0, 500.0, 391.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 435.0, 500.0, 500.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 302, 500, 500, 500, 500, 500, 350, 207, 429, 500, 500, 500, 325, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 454, 500, 231, 379, 500, 500, 500, 500, 457, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 324, 402, 500, 500, 500, 439, 500, 500, 500, 425, 500, 500, 363, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 314, 500, 415, 500, 500, 500, 391, 500, 500, 500, 500, 500, 500, 435, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5030812238499134, "mean_inference_ms": 1.6563421000351797, "mean_action_processing_ms": 0.12444791957644523, "mean_env_wait_ms": 0.0639249175561622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005317211151123047, "StateBufferConnector_ms": 0.004159688949584961, "ViewRequirementAgentConnector_ms": 0.2982957363128662}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.5234963119968, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 76000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 15123.362, "sample_time_ms": 9437.681, "synch_weights_time_ms": 3.244}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 535, "training_iteration": 19, "trial_id": "33eb6_00000", "date": "2023-07-30_13-59-32", "timestamp": 1690725572, "time_this_iter_s": 15.125651121139526, "time_total_s": 457.96208143234253, "pid": 12451, "hostname": "codespaces-24c3ba", "node_ip": "172.16.5.4", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "CartPole-v1", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f960c1ce050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 2, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 457.96208143234253, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 32.66190476190476, "ram_util_percent": 83.71428571428571}}
